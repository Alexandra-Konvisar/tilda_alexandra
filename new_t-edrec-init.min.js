function editRecordContent(recordid){edrec__editRecordContent(recordid)}function editRecordSettings(recordid){edrec__editRecordSettings(recordid)}function edrec__editRecordContent(recordid){window.edrec_v="1",showLoadIcon(),$("#record"+recordid).find(".tp-record-edit-icons-left__three").css("pointer-events","none");var ts=Date.now();$.ajax({type:"POST",url:"/page/edit/",data:{pageid:window.pageid,recordid:recordid,tab:"content"},dataType:"text",success:function(datastr){if(check_logout(datastr),savesortmodeifactive(),""==datastr)alert("Error. Empty response from server");else{var data=edrec__parseJson(datastr);"object"==typeof data&&edrec__content__drawPanel(data)}},error:function(xhr){var ts_delta=Date.now()-ts;0==xhr.status&&ts_delta<100?alert("Request error (opening block content panel). Please check internet connection..."):(errorLog({e:"timeout",data:{pageid:window.pageid,recordid:recordid,tab:"content"},xhr:xhr.status,ts:ts_delta}),alert("Request timeout (opening block content panel)"))},complete:function(xhr){hideLoadIcon(),$("#record"+recordid).find(".tp-record-edit-icons-left__three").css("pointer-events","auto")},timeout:6e4}),$("#editformsxl").scrollGuard()}function edrec__editRecordSettings(recordid){window.edrec_v="1",window.group_height_coord={},showLoadIcon(),$("#record"+recordid).find(".tp-record-edit-icons-left__two").css("pointer-events","none");var ts=Date.now();$.ajax({type:"POST",url:"/page/edit/",data:{pageid:window.pageid,recordid:recordid,tab:"settings"},dataType:"text",success:function(datastr){if(check_logout(datastr),savesortmodeifactive(),""==datastr)alert("Error. Empty response from server");else{var data=edrec__parseJson(datastr);"object"==typeof data&&edrec__settings__drawPanel(data)}},error:function(xhr){var ts_delta=Date.now()-ts;0==xhr.status&&ts_delta<100?alert("Request error (opening block settings panel). Please check internet connection..."):(errorLog({e:"timeout",data:{pageid:window.pageid,recordid:recordid,tab:"settings"},xhr:xhr.status,ts:ts_delta}),alert("Request timeout (opening block settings panel)"))},complete:function(xhr){hideLoadIcon(),$("#record"+recordid).find(".tp-record-edit-icons-left__two").css("pointer-events","auto")},timeout:6e4})}function edrec__editRecordInit(){window.settingstab_scroll_obj={},window.contenttab_scroll_obj={};var recid=0;edrec__createScrollObj(0),$("body").on("click","#editforms .pe-form-group-title-wrapper",(function(){var top=$(this).position().top+parseInt($(this).css("margin-top"));edrec__opengroupitems($(this),$(this).attr("data-tpl-group"),top)})),$("body").on("click","#editforms .pe-form-group-close",(function(){edrec__closegroupitems()})),$(document).on("mousedown",(function(e){$(e.target).closest(".pe-form-group-title-wrapper").length||$(e.target).closest(".pe-form-group-wrapper.pe-form-group-wrapper_open").length||edrec__closegroupitems(),e.stopPropagation()})),$("body").on("click","#editformsxl .pe-form-group-title-wrapper",(function(){edrec__collapsecontentgroups($(this).attr("data-tpl-group"))})),$("body").find("#editforms").addClass("t-editforms_team"),$("body").find("#editformsxl").addClass("t-editforms_team")}function edrec__createScrollObj(recid){$(".record").each((function(){recid=$(this).attr("recordid"),window.settingstab_scroll_obj[recid]={coord:0,timer:0},window.contenttab_scroll_obj[recid]={coord:0,timer:0,groupOpen:[]}}))}function edrec__parseJson(datastr){try{var obj=JSON.parse(datastr);if("object"==typeof obj)return obj;alert("Server response(edit record) error: "+datastr)}catch(e){alert("Server response error: "+datastr),console.log("Error parse server response! error:"+e),console.log(datastr)}}function showEditFormXL(){edrec__showEditFormXL()}function showEditForm(){edrec__showEditForm()}function closeEditForm(){edrec__closeEditForm()}function edrec__showEditForm(){$("#editforms").css({height:"100%"}),$("#closelayer").css({height:"100%"}),$("#closelayer").unbind("click").click((function(){(void 0===window.edrec_isChanged||"y"!=window.edrec_isChanged||(console.log("closed without saving changes"),confirm("RU"==lang?"Последние изменения не сохранены. Закрыть панель?":"You have unsaved changes. Are you sure you want to close this panel?")))&&edrec__closeEditForm()})),$("#mainmenu").finish(),$("#mainmenu").css("top","-60px"),$("#editforms").css("left","-100px"),$("#editforms").css("visibility","visible"),$("#editforms").animate({opacity:"1",left:"0px"},500,"easeOutCirc")}function edrec__showEditFormXL(){$("#closelayer").css({height:"100%"}),$("#closelayer").unbind("click").click((function(){(void 0===window.edrec_isChanged||"y"!=window.edrec_isChanged||(console.log("closed without saving changes"),confirm("RU"==lang?"Последние изменения не сохранены. Закрыть панель?":"You have unsaved changes. Are you sure you want to close this panel?")))&&edrec__closeEditForm()})),$("#mainmenu").finish(),$("#mainmenu").css("top","-60px"),$("#editformsxl").css({overflow:"auto"}),$("#editformsxl").css({"overflow-x":"hidden"}),$("#editformsxl").css({height:"100%"}),$("#editformsxl").css("left","-100px"),$("#editformsxl").css("visibility","visible"),$("#editformsxl").animate({opacity:"1",left:"0px"},500,"easeOutCirc"),delete window.edrec_isChanged}function edrec__closeEditForm(){if($("#editforms .edrec__wrapper").length>0){var settingsRecid=$("#editforms").find(".pe-settings-form").attr("data-rec-id"),settingsScrollObj;edrec__saveScrollCoord(settingsRecid,window.settingstab_scroll_obj[settingsRecid],!1)}else if($("#editformsxl").length>0){var contentRecid=$("#editformsxl").find(".pe-content-form").attr("data-rec-id"),contentScrollObj;edrec__saveScrollCoord(contentRecid,window.contenttab_scroll_obj[contentRecid],!0)}$("#editforms").css({height:"1px"}),$("#editforms").css("visibility","hidden"),$("#editforms").html(""),$("#closelayer").css({height:"1px"}),$("#mainmenu").stop(),$("#mainmenu").animate({opacity:"1",top:"0px"},400,"easeOutCirc"),$("#editformsxl").css({height:"1px"}),$("#editformsxl").css("visibility","hidden"),$("#editformsxl").html(""),$(".pe-content__videolink-tooltip").remove(),delete window.edrec_isChanged}function edrec__keyUpFunc(e){if(27==e.keyCode){if(void 0!==window.edrec_isChanged&&"y"==window.edrec_isChanged&&(console.log("closed without saving changes"),!confirm("RU"==lang?"Последние изменения не сохранены. Закрыть панель?":"You have unsaved changes. Are you sure you want to close this panel?")))return;edrec__closeEditForm(),$(document).off("keyup",edrec__keyUpFunc)}}function edrec__addScrollCoord(form,scrollObj,isContent){isContent&&edrec__addOpenGroup(scrollObj),void 0!==scrollObj&&(form.scrollTop(scrollObj.coord),clearTimeout(scrollObj.timer))}function edrec__addOpenGroup(scrollObj){void 0!==scrollObj&&void 0!==scrollObj.groupOpen&&scrollObj.groupOpen.length>0&&scrollObj.groupOpen.forEach((function(item){$("#grouptitle_"+item).addClass("pe-form-group-title-wrapper_open"),$("#grouptitle_"+item).find(".pe-form-group-arrow").addClass("pe-form-group-arrow_open"),$("#group_"+item).addClass("pe-form-group-wrapper_open")}))}function edrec__saveScrollCoord(recid,scrollObj,isContent){var unsetTime=6e5,coord=isContent?$("#editformsxl").scrollTop():$("#editforms .pe-container-overflow").scrollTop(),obj=isContent?{coord:0,timer:0,groupOpen:[]}:{coord:0,timer:0};void 0===scrollObj&&(isContent?(window.contenttab_scroll_obj[recid]=obj,scrollObj=window.contenttab_scroll_obj[recid]):(window.settingstab_scroll_obj[recid]=obj,scrollObj=window.settingstab_scroll_obj[recid])),scrollObj.coord=coord,scrollObj.timer=setTimeout((function(){scrollObj.coord=0,isContent&&(scrollObj.groupOpen=[])}),6e5)}function edrec__saveOpenGroup(el){var recid=el.parents(".pe-content-form").attr("data-rec-id"),scrollObj=window.contenttab_scroll_obj[recid];$(".pe-form-group-title-wrapper_open").length>0&&void 0!==scrollObj&&(scrollObj.groupOpen=[],$(".pe-form-group-title-wrapper_open").each((function(){scrollObj.groupOpen.push($(this).attr("data-tpl-group"))})))}function edrec__content__drawPanel(data){showEditFormXL();var str="";str+='<div id="formbox'+data.record.id+'">',str+='\t<form id="form'+data.record.id+'" name="form'+data.record.id+'" role="form" enctype="multipart/form-data" action="/page/submit/" onsubmit="return false;" method="POST" class="pe-content-form" data-rec-tplid="'+data.record.tplid+'" data-rec-id="'+data.record.id+'">',str+='\t<div class="pe-content__form-wrapper">',str+='\t\t\t<div class="pe-content__savebtns-wrapper updatesavebuttons_content" id="updatesaveeditrecordsettingsbuttons" style="position:fixed;">',str+='\t\t\t\t<table class="pe-content__savebtns-table" style="width:100%;">',str+="\t\t\t\t<tr>",!0===isMobile&&(str+='\t\t\t\t<td style="width:1%;"><button class="tbtn" style="width:60px; display: table-cell; background-color:#999" onclick="edrec__closeEditForm();return false;">'+(lang,"X")+"</button></td>"),str+='\t\t\t\t<td style="width:50%;"><button class="tbtn" style="width:100%; display: table-cell;" onclick="edrec__content__sendform(\'update\');return false;">'+("RU"==lang?"Сохранить":"Save")+"</button></td>",str+='\t\t\t\t<td style="width:50%;"><button class="tbtn tbtn-primary" style="width:100%; display: table-cell;" onclick="edrec__content__sendform();return false;">'+("RU"==lang?"Сохранить и закрыть":"Save and close")+"</button></td>",str+="\t\t\t\t</tr>",str+="\t\t\t\t</table>",str+="\t\t\t</div>",str+='\t\t\t<div class="edrec__wrapper panel-body editrecordcontent_container">';var videolink="",tooltipText="",isVideoIconShow=!1;"RU"==lang?void 0!==data.tpl.youtubelink_ru&&""!=data.tpl.youtubelink_ru&&(videolink=data.tpl.youtubelink_ru,tooltipText="Видеоинструкция",isVideoIconShow=!0):void 0!==data.tpl.youtubelink&&""!=data.tpl.youtubelink&&(videolink=data.tpl.youtubelink,tooltipText="Video Tip",isVideoIconShow=!0),isVideoIconShow&&(str+='\t\t\t\t<div class="pe-content__videolink-wrapper">',str+='\t\t\t\t\t<a href="'+videolink+'" target="_blank">',str+='\t\t\t\t\t\t<div class="pe-content__videolink-icon-wrapper">',str+='\t\t\t\t\t\t\t<svg class="pe-content__videolink-icon" width="36" height="33" viewBox="0 0 36 33" fill="none" xmlns="http://www.w3.org/2000/svg">',str+='\t\t\t\t\t\t\t\t<circle class="pe-content__videolink-icon-stroke" cx="27.254" cy="8.746" r="7.996" stroke="#000" stroke-width="1.5"/>',str+='\t\t\t\t\t\t\t\t<path class="pe-content__videolink-icon-stroke" d="M27.252 13.994V6.997M27.252 5.249v-1.75" stroke="#000" stroke-width="2"/>',str+='\t\t\t\t\t\t\t\t<path class="pe-content__videolink-icon-play" d="M13.025 24.026V16.82l5.024 3.602-5.024 3.603z" fill="#000" stroke="#000"/>',str+='\t\t\t\t\t\t\t\t<path class="pe-content__videolink-icon-stroke" d="M13.91 8.348H4a3 3 0 00-3 3v17.32a3 3 0 003 3h22.318a3 3 0 003-3v-7.41" stroke="#000" stroke-width="1.5"/>',str+="\t\t\t\t\t\t\t</svg>",str+="\t\t\t\t\t\t</div>",str+="\t\t\t\t\t</a>",str+="\t\t\t\t</div>"),$("body").append('<div class="pe-content__videolink-tooltip">'+tooltipText+"</div>"),str+='\t\t\t\t<div id="preview'+data.record.id+'" style="color:red;margin-bottom:20px;"></div>',void 0!==data.tpl.ts_old&&""!=data.tpl.ts_old&&("RU"==lang?str+='<div class="pe-form-group__old-notice">Этот блок находится в архиве и больше не поддерживается. Он продолжит работать, но со временем есть вероятность появления ошибок. Мы рекомендуем по возможности его обновить, добавив новую версию блока из библиотеки, и перенести в него текущий контент.</div>':str+="<div class=\"pe-form-group__old-notice\">This block is in the archive and it's not supported anymore. It will work but in a while, there's an error probability. We recommend, when possible, to renew it by adding a new version of the block from the library and moving the content to it.</div>"),"RU"==lang&&void 0!==data.tpl.help_content_ru&&""!=data.tpl.help_content_ru?str+='<div class="pe-form-group__help-content pe-form-group__help-content_top">'+data.tpl.help_content_ru+"</div>":void 0!==data.tpl.help_content&&""!=data.tpl.help_content&&(str+='<div class="pe-form-group__help-content pe-form-group__help-content_top">'+data.tpl.help_content+"</div>"),str+="\t\t\t</div>",str+='\t\t<input type="hidden" name="comm" value="saverecord">',str+='\t\t<input type="hidden" name="recordid" value="'+data.record.id+'">',str+='\t\t<input type="hidden" name="pageid" value="'+data.record.pageid+'">',str+="\t</div>",str+="\t</form>",str+="</div>",$("#editformsxl").html(str);var wrapper=$(".edrec__wrapper"),fields=data.tpl.fields.split(","),ui={},field;for(var key in fields)field=fields[key],edrec__drawUI(ui=edrec__drawUI__getFieldObj__content(field),data,field,wrapper),"gr"==ui.type&&(wrapper=$(".edrec__wrapper").find("#group_"+ui.groupid)),"|ggc|"==field&&(wrapper=$(".edrec__wrapper"));if(edrec__drawUI__podcut(data,fields,wrapper),"RU"==lang&&void 0!==data.tpl.help_b_content_ru&&""!=data.tpl.help_b_content_ru?wrapper.append('<div class="pe-form-group__help-content pe-form-group__help-content_bottom">'+data.tpl.help_b_content_ru+"</div>"):void 0!==data.tpl.help_b_content&&""!=data.tpl.help_b_content&&wrapper.append('<div class="pe-form-group__help-content pe-form-group__help-content_bottom">'+data.tpl.help_b_content+"</div>"),edrec__content__init(wrapper),void 0!==data.tpl.replaces&&""!=data.tpl.replaces){var foo=JSON.parse(data.tpl.replaces),foo;"object"==typeof(foo=JSON.parse(foo))&&edrec__replaces(foo,wrapper)}var recordid=$("#editformsxl").find(".pe-content-form").attr("data-rec-id"),scrollObj=window.contenttab_scroll_obj[recordid],form;edrec__addScrollCoord($("#editformsxl.t-editforms_team"),scrollObj,!0),$("#updatesaveeditrecordsettingsbuttons").animate({opacity:"1",left:"0px"},500,"easeOutCirc",(function(){})),$(document).on("keyup",edrec__keyUpFunc),876!=data.record.tplid&&776!=data.record.tplid&&754!=data.record.tplid&&778!=data.record.tplid&&786!=data.record.tplid&&973!=data.record.tplid||void 0!==data.record.storepart&&data.record.storepart>1||(wrapper.find('.pe-form-group[data-tpl-field="storebtntitleprod"]').css("display","none"),wrapper.find('.pe-form-group[data-tpl-field="storebtnlinkprod"]').css("display","none"),wrapper.find('.pe-form-group[data-tpl-field="storebtntitleprod2"]').css("display","none"),wrapper.find('.pe-form-group[data-tpl-field="storebtnlinkprod2"]').css("display","none")),window.edrec_isChanged="",wrapper.find(":input").change((function(){window.edrec_isChanged="y"})),setTimeout((function(){$(".edrec__wrapper").find(".redactor-editor").each((function(){var el=$(this);el.find("div").length&&el.find("div").each((function(){var color=$(this).css("color");if("string"==typeof color&&color.indexOf("rgb(")>-1){var rgb=color.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),yiq;(299*rgb[1]+587*rgb[2]+114*rgb[3])/1e3>170&&el.css("background-color","#7b7b7b")}}))}))}),1e3);var videoTooltip=$(".pe-content__videolink-tooltip");$(".pe-content__videolink-icon-wrapper").hover((function(){var topCoord=$(".pe-content__videolink-wrapper").position().top;videoTooltip.css("top",topCoord),videoTooltip.css("z-index","99999"),videoTooltip.addClass("pe-content__videolink-tooltip_show")}),(function(){videoTooltip.removeClass("pe-content__videolink-tooltip_show")}))}function edrec__settings__drawPanel(data){showEditForm(),void 0===data.record.screenmin&&(data.record.screenmin=""),void 0===data.record.screenmax&&(data.record.screenmax="");var str="";str+='<div class="pe-container-overflow">',str+='<div id="formbox'+data.record.id+'">',str+='\t<form id="form'+data.record.id+'" name="form'+data.record.id+'" role="form" enctype="multipart/form-data" action="/page/submit/" onsubmit="return false;" method="POST" class="pe-settings-form" data-rec-tplid="'+data.record.tplid+'" data-rec-id="'+data.record.id+'">',str+='\t<div class="pe-settings__form-wrapper">',str+='\t\t\t<div class="pe-settings__savebtns-wrapper" id="updatesaveeditrecordsettingsbuttons" style="position:fixed;">',str+='\t\t\t\t<table class="pe-settings__savebtns-table">',str+="\t\t\t\t<tr>",str+='\t\t\t\t<td><button class="tbtn" style="width:160px; display: table-cell; '+("RU"==lang?"font-size:14px;":"")+'" onclick="edrec__settings__sendform(\'update\');return false;">'+("RU"==lang?"Сохранить":"Save")+"</button></td>",str+='\t\t\t\t<td><button class="tbtn tbtn-primary" style="width:161px; display: table-cell; '+("RU"==lang?"font-size:14px;":"")+'" onclick="edrec__settings__sendform();return false;">'+("RU"==lang?"Сохранить и закрыть":"Save and close")+"</button></td>",str+="\t\t\t\t</tr>",str+="\t\t\t\t</table>",str+="\t\t\t</div>",str+='\t\t\t<div class="edrec__wrapper panel-body" style="width:290px; padding-top:70px;">',str+='\t\t\t\t<div id="preview'+data.record.id+'" style="color:red;margin-bottom:20px;"></div>',void 0!==data.tpl.editnotpublish&&"y"==data.tpl.editnotpublish&&(str+='<br><table style="width:100%; border:3px solid #ffcf5d;"><tr><td style="padding:15px; font-size:11px;">'+("RU"==lang?"Примечание: Вид данного блока и его поведение в режиме редактирования может отличаться от вида в режиме предпросмотра или публикации.":"Appearance of this block in the editing mode might be different from its appearance on preview and on published page.")+"</td></tr></table>"),""==data.record.screenmax&&""==data.record.screenmin||(str+='<table style="width:100%; border:3px solid blue; margin-bottom:30px;"><tr><td style="padding:15px; font-size:11px;">'+("RU"==lang?"Примечание: Для этого блока установлено ограничение на отображение на различных размерах экрана. Блок будет отображаться на экранах шириной от ":"There's a display restriction applied to this block. This block will appear only on screens that are ")+" "+(""==data.record.screenmin?"0px":data.record.screenmin)+" "+("RU"==lang?"до":"-")+" "+(""==data.record.screenmax?"&infin;":data.record.screenmax)+"</td></tr></table>"),"RU"==lang&&void 0!==data.tpl.help_settings_ru&&""!=data.tpl.help_settings_ru?str+=data.tpl.help_settings_ru:void 0!==data.tpl.help_settings&&""!=data.tpl.help_settings&&(str+=data.tpl.help_settings),str+="\t\t\t</div>",str+='\t\t<input type="hidden" name="comm" value="saverecord">',str+='\t\t<input type="hidden" name="recordid" value="'+data.record.id+'">',str+='\t\t<input type="hidden" name="pageid" value="'+data.record.pageid+'">',str+="\t</div>",str+="\t</form>",str+="</div>",str+="</div>",$("#editforms").html(str);var wrapper=$(".edrec__wrapper");void 0!==data.tpl.nodeff&&"y"==data.tpl.nodeff||(data.tpl.fields+=",margintop,margintop_res_480,marginbottom,marginbottom_res_480,blockbackground",void 0===data.tpl.is_email&&(data.tpl.fields+=",animationoff,screenmin,screenmax"));var fields=data.tpl.fields.split(","),ui={},field;for(var key in fields)field=fields[key],edrec__drawUI(ui=edrec__drawUI__getFieldObj(field),data,field,wrapper),"gr"==ui.type&&(wrapper=$(".edrec__wrapper").find("#group_"+ui.groupid)),"|gc|"==field&&(wrapper=$(".edrec__wrapper"));if(edrec__drawUI__podcut(data,fields,wrapper),$(".pe-minicolors").minicolors(),$(".checkbox-btn").styler(),setTimeout((function(){$(".panel-body").find(".pe-hint").each((function(){""==$(this).html()&&$(this).css("padding","0px")}))}),50),void 0!==data.tpl.zeroid&&data.tpl.zeroid>1&&edrec__drawUI__converttozero(data,wrapper),wrapper.append('<div style="font-size:11px; color:#777; padding-top:30px;">Block id: #rec'+data.record.id+"</div><br><br><br>"),void 0!==data.tpl.replaces&&""!=data.tpl.replaces){var foo=JSON.parse(data.tpl.replaces),foo;"object"==typeof(foo=JSON.parse(foo))&&edrec__replaces(foo,wrapper)}var recordid=$("#editforms").find(".pe-settings-form").attr("data-rec-id"),scrollObj=window.settingstab_scroll_obj[recordid],form;edrec__addScrollCoord($("#editforms.t-editforms_team .pe-container-overflow"),scrollObj,!1),$("#updatesaveeditrecordsettingsbuttons").animate({opacity:"1",left:"0px"},500,"easeOutCirc",(function(){})),$(document).on("keyup",edrec__keyUpFunc),876!=data.record.tplid&&776!=data.record.tplid&&754!=data.record.tplid&&778!=data.record.tplid&&786!=data.record.tplid&&973!=data.record.tplid||void 0!==data.record.storepart&&data.record.storepart>1||(wrapper.find('.pe-form-group[data-tpl-group="group18"]').css("display","none"),wrapper.find('.pe-form-group[data-tpl-field="store_showoptsingrid"]').css("display","none"),wrapper.find('.pe-form-group[data-tpl-field="showrelevants"]').css("display","none"),wrapper.find('.pe-form-group[data-tpl-field="titlerelevants"]').css("display","none")),window.edrec_isChanged="",wrapper.find(":input").change((function(){window.edrec_isChanged="y"}))}function edrec__drawUI(ui,data,field,wrapper){var value=data.record[field];void 0===value&&(value=""),void 0!==ui.label?"object"==typeof ui.label&&(void 0!==ui.label[lang]&&""!=ui.label[lang]?ui.label=ui.label[lang]:void 0!==ui.label.EN&&""!=ui.label.EN&&(ui.label=ui.label.EN)):ui.label="",void 0!==ui.ph?"object"==typeof ui.ph&&(void 0!==ui.ph[lang]&&""!=ui.ph[lang]?ui.ph=ui.ph[lang]:void 0!==ui.ph.EN&&""!=ui.ph.EN&&(ui.ph=ui.ph.EN)):ui.ph="",void 0!==ui.hint?"object"==typeof ui.hint&&(void 0!==ui.hint[lang]&&""!=ui.hint[lang]?ui.hint=ui.hint[lang]:void 0!==ui.hint.EN&&""!=ui.hint.EN?ui.hint=ui.hint.EN:ui.hint=""):ui.hint="","sb"==ui.type?edrec__drawUI__select(ui,value,data,field,wrapper):"in"==ui.type?edrec__drawUI__input(ui,value,data,field,wrapper):"te"==ui.type?edrec__drawUI__text(ui,value,data,field,wrapper):"cb"==ui.type?edrec__drawUI__checkbox(ui,value,data,field,wrapper):"co"==ui.type?edrec__drawUI__color(ui,value,data,field,wrapper):"ff"==ui.type?edrec__drawUI__font(ui,value,data,field,wrapper):"gr"==ui.type?edrec__drawUI__group(ui,value,data,field,wrapper):"im"==ui.type?edrec__drawUI__image(ui,value,data,field,wrapper):"ln"==ui.type?edrec__drawUI__Link(ui,value,data,field,wrapper):"screen"==ui.type?edrec__drawUI__screen(ui,value,data,field,wrapper):"spec"==ui.type?edrec__drawUI__special(ui,value,data,field,wrapper):"skip"==ui.type||void 0!==ui.type&&edrec__drawUI__input(ui,value,data,field,wrapper),void 0!==ui.split&&""!=ui.split&&edrec__drawUI__split(ui.split,field)}function edrec__drawUI__input(ui,value,data,field,wrapper){""==ui.label&&(ui.label=field);var str="";str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='    <label class="pe-label">'+ui.label+"</label>",str+='    <div class="">',str+='    \t<input type="text" name="'+field+'" class="pe-input" placeholder="'+ui.ph+'" value="'+value+'" />',str+='    \t<div class="pe-hint">'+ui.hint+"</div>",str+="\t</div>",str+="</div>",wrapper.append(str)}function edrec__drawUI__text(ui,value,data,field,wrapper){""==ui.label&&(ui.label=field);var str="";str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',str+='    <label class="pe-label">'+ui.label+"</label>",str+='    <div class="pe-redactor '+("y"==ui.rno?"pe-noredactor":"")+'">',str+='    \t<textarea name="'+field+'" class="pe-textarea '+("y"==ui.rno?"noredactor":"")+'" '+("y"==ui.rmin?'redaktormin="yes"':"")+" "+(ui.rows>0?'rows="'+ui.rows+'"':"")+' placeholder="'+ui.ph+'">'+value+"</textarea>",str+="    </div>",str+='<div class="pe-hint">'+ui.hint+"</div>",str+="</div>",wrapper.append(str)}function edrec__drawUI__color(ui,value,data,field,wrapper){var uplabel="";void 0!==ui.uplabel&&("string"==typeof ui.uplabel&&(uplabel=ui.uplabel),"object"==typeof ui.uplabel&&(void 0!==ui.uplabel[lang]&&""!=ui.uplabel[lang]?uplabel=ui.uplabel[lang]:void 0!==ui.uplabel.EN&&""!=ui.uplabel.EN&&(uplabel=ui.uplabel.EN))),""==ui.label&&(ui.label=field),"bgcolor"==field&&"em"==data.tpl.kind&&(ui.label=("RU"==lang?"Контейнер":"Container")+": "+ui.label);var str="";str+='<div class="pe-form-group" data-tpl-field="'+field+'">',""!=uplabel&&(str+='    <label class="pe-label">'+uplabel+"</label><br>"),""!=ui.label&&(str+='    <label class="pe-label">'+ui.label+"</label>"),str+='    <div class="pe-color">',str+='    \t<input type="text" name="'+field+'" class="pe-input pe-minicolors" placeholder="'+ui.ph+'" value="'+value+'" />',str+='    \t<div class="pe-hint">'+ui.hint+"</div>",str+="\t</div>",str+="</div>",wrapper.append(str)}function edrec__drawUI__select(ui,value,data,field,wrapper){""==ui.label&&(ui.label=field);var options=[];"object"==typeof ui.options&&(options=ui.options),"columns"!=field&&"bcolumns"!=field||"131"==data.record.tplid&&options.push({v:"100",RU:"100%",EN:"100%"}),"margintop"==field&&(ui.label='<span style="postion:relative;"><a href="javascript:edrec__settings_showmarginsmob();" style="position:absolute; top:-3px; left:0;"><img src="/tpl/img/page/pe-desctop.svg" class="tooltip" style="opacity:0.2;width:20px;" data-tooltip="'+("RU"==lang?"Нажмите, чтобы задать отступы<br>для мобильного":"Click to set margins for mobile")+' (<=480px)"></a><span style="padding-left:25px;">'+ui.label+"</span></span>"),"margintop_res_480"==field&&(ui.label='<span style="position:absolute; top:-3px; left:0;"><img src="/tpl/img/page/pe-mobile.svg" style="opacity:0.2;width:20px;"></span><span style="padding-left:25px;">'+ui.label+"</span>"),void 0!==ui.uphint?"object"==typeof ui.uphint&&"undefined"!=ui.uphint[lang]&&""!=ui.uphint[lang]&&(ui.uphint=ui.uphint[lang]):ui.uphint="";var isHidden=!1;void 0!==ui.display&&"none"==ui.display?isHidden=!0:"store_sort"!==field&&"store_tabs"!==field&&"price_range_format"!==field||(isHidden=void 0===data.record.storepart||data.record.storepart<1);var str="";if(str+='<div class="pe-form-group" data-tpl-field="'+field+'" '+(isHidden?'style="display:none;"':"")+">",""!=ui.uphint&&(str+='    <div class="pe-hint-up">'+ui.uphint+"</div>"),str+='    <label class="pe-label">'+ui.label+"</label>",str+='    <div class="pe-select">',str+='\t\t<select class="pe-input pe-select" name="'+field+'">',"showrelevants"==field&&"object"==typeof data.storeparts)str+='<option value="'+options[0].v+'" '+(value==options[0].v?"selected":"")+">"+(void 0!==options[0][lang]?options[0][lang]:options[0].EN)+"</option>";else for(var i=0;i<options.length;i++)str+='<option value="'+options[i].v+'" '+(value==options[i].v?"selected":"")+">"+(void 0!==options[i][lang]?options[i][lang]:options[i].EN)+"</option>";if("showrelevants"==field&&"object"==typeof data.storeparts)for(var ii in data.storeparts)str+='<option value="'+data.storeparts[ii].uid+'" '+(data.storeparts[ii].uid==data.record.showrelevants?'selected="selected"':"")+">"+("RU"==lang?"Раздел: ":"Part: ")+data.storeparts[ii].title+"</option>";str+="\t\t</select>",str+="    </div>",str+='    \t<div class="pe-hint">'+ui.hint+"</div>",str+="</div>",wrapper.append(str),"margintop_res_480"!=field&&"marginbottom_res_480"!=field||""!=value&&(wrapper.find('.pe-form-group[data-tpl-field="margintop_res_480"]').css("display","block"),wrapper.find('.pe-form-group[data-tpl-field="marginbottom_res_480"]').css("display","block"))}function edrec__drawUI__checkbox(ui,value,data,field,wrapper){var caption=field;void 0!==ui.caption&&("string"==typeof ui.caption&&(caption=ui.caption),"object"==typeof ui.caption&&(void 0!==ui.caption[lang]&&""!=ui.caption[lang]?caption=ui.caption[lang]:void 0!==ui.caption.EN&&""!=ui.caption.EN&&(caption=ui.caption.EN)));var str="",isHidden=!1;"store_onlyinstock"!==field&&"showpagination"!==field||(isHidden=void 0===data.record.storepart||data.record.storepart<1),str+='<div class="pe-form-group" data-tpl-field="'+field+'"'+(isHidden?'style="display:none;"':"")+">",""!=ui.label&&(str+='    <label class="pe-label">'+ui.label+"</label>"),str+='    <div class="pe-checkbox-box">',str+='\t\t<label class="pe-label-checkbox">',str+='    \t\t<input type="hidden" name="'+field+'" class="pe-input" value="'+value+'" />',str+='    \t\t<input type="checkbox" name="'+field+'-cb" '+("on"==value?'checked="checked"':"")+'/>&nbsp;<span class="pe-checkbox-title">'+caption+"</span>",str+="\t\t</label>",str+='    \t<div class="pe-hint" style="padding:0;">'+ui.hint+"</div>","buttonstat"!=field&&"buttonstat2"!=field&&"buttonstat3"!=field&&"allbuttonsstat"!=field||(str+='    <div class="pe-hint" style="padding-top:0; '+("on"==value?"":"display:none;")+'">',str+=("RU"==lang?"Клик будет отображаться в системе аналитики, как просмотр страницы: ":"Button click displays in analytic system as page view: ")+"/tilda/click/rec"+data.record.id+"/button"+("buttonstat"==field?"1":"buttonstat2"==field?"2":"buttonstat3"==field?"3":"allbuttonsstat"==field?"N":""),str+="\t</div>"),"popupstat"==field&&(str+='    <div class="pe-hint" style="padding-top:0; '+("on"==value?"":"display:none;")+'">',str+=("RU"==lang?"Открытие попапа будет отображаться в системе аналитики, как просмотр страницы: ":"You can setup popup opening as a goal in the analytic system as a view of virtual page: ")+"/tilda/popup/rec"+data.record.id+"/opened<br>FB pixel: 'ViewContent' event",str+="\t</div>"),str+="\t</div>",str+="</div>",wrapper.append(str),wrapper.find('input[name="'+field+'-cb"]').change((function(){var tempv=$(this).is(":checked");tempv=tempv?"on":"",wrapper.find('input[name="'+field+'"]').val(tempv),"buttonstat"!=field&&"buttonstat2"!=field&&"buttonstat3"!=field&&"allbuttonsstat"!=field&&"popupstat"!=field&&"paymentstat"!=field&&"formstat"!=field||(tempv?$(this).parent().parent().find(".pe-hint").show():$(this).parent().parent().find(".pe-hint").hide())}))}function edrec__drawUI__font(ui,value,data,field,wrapper){""==ui.label&&(ui.label=field);var options=[];"object"==typeof ui.options&&(options=ui.options);var str="";str+='<div class="pe-form-group" data-tpl-field="'+field+'" '+(void 0!==ui.display&&"none"==ui.display?'style="display:none;"':"")+">",str+='    <label class="pe-label">'+ui.label+"</label>",str+='    <div class="pe-select">',str+='\t\t<select class="pe-input pe-select" name="'+field+'">',str+='\t\t\t<option value="" '+(""==value?"selected":"")+">"+("RU"==lang?"По умолчанию":"Default")+"</option>","Arial"!=$headlinefont&&"Arial"!=$textfont&&(str+='\t\t\t<option value="Arial" '+("Arial"==value?"selected":"")+">Arial</option>"),"Georgia"!=$headlinefont&&"Georgia"!=$textfont&&(str+='\t\t\t<option value="Georgia" '+("Georgia"==value?"selected":"")+">Georgia</option>"),""!=$headlinefont&&(str+='\t\t\t<option value="'+$headlinefont+'" '+(value==$headlinefont?"selected":"")+">"+$headlinefont+"</option>"),""!=$textfont&&(str+='\t\t\t<option value="'+$textfont+'" '+(value==$textfont?"selected":"")+">"+$textfont+"</option>"),str+="\t\t</select>",str+="    </div>",""!=ui.hint&&(str+='    \t<div class="pe-hint">'+ui.hint+"</div>"),str+="</div>",wrapper.append(str)}function edrec__drawUI__group(ui,value,data,field,wrapper){var str="",groupid=ui.groupid;"|gc|"!=field&&"|ggc|"!=field&&(str+='\t<div class="pe-form-group-title-wrapper" data-tpl-group="'+groupid+'" id="grouptitle_'+groupid+'">',str+='\t\t<span class="pe-form-group-title tsgrouptitle">'+ui.label+"</span>",str+='\t\t<span class="pe-form-group-arrow"></span>',str+="\t</div>",str+='\t<div class="pe-form-group-wrapper" id="group_'+groupid+'">',str+='\t\t<div class="pe-form-group-close-wrapper">',str+='\t\t\t<div class="pe-form-group-close">',str+='\t\t\t\t<svg width="9" height="10" viewBox="0 0 9 10" fill="none" xmlns="http://www.w3.org/2000/svg">',str+='\t\t\t\t\t<path fill-rule="evenodd" clip-rule="evenodd" d="M4.354 4.293L.707.646 0 1.354 3.646 5 0 8.646l.707.708 3.647-3.647L8 9.354l.707-.708L5.061 5l3.646-3.646L8 .646 4.354 4.293z" fill="#555"/>',str+="\t\t\t\t</svg>",str+="\t\t\t</div>",str+="\t\t</div>",str+="\t</div>"),wrapper.append(str)}function edrec__drawUI__image(ui,value,data,field,wrapper){var str="";str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='\t<label class="pe-label">'+ui.label+"</label>",str+="\t<br>",str+='\t<div class="js-image-box js-image-box__'+field+'">',str+='\t\t<table style="width:100%;">',str+="\t\t<tr>",str+='\t\t<td style="width:240px; vertical-align:top;">',str+='\t\t<div style="width:100%;">',str+='\t\t<input type="text" name="'+field+'-tubutton" class="js-img-button" value="" data-tu-is-image="yes" id="tuwidget'+data.record.id+field+'" />',str+='\t\t<input type="hidden" name="'+field+'-tuinfo-uuid" class="js-img-uuid" value="" />',str+='\t\t<input type="hidden" name="'+field+'-tuinfo-cdnurl" class="js-img-cdnurl" value=""/>',str+='\t\t<input type="hidden" name="'+field+'-tuinfo-name" class="js-img-name" value=""/>',str+='\t\t<input type="hidden" name="'+field+'-tuinfo-width" class="js-img-width" value=""/>',str+='\t\t<input type="hidden" name="'+field+'-tuinfo-height" class="js-img-height" value=""/>',str+='\t\t<input type="hidden" name="'+field+'-tuinfo-size" class="js-img-size" value=""/>',str+='\t\t<input type="hidden" name="'+field+'-uploadmethod" value="tu"/>',str+='\t\t<input type="hidden" name="'+field+'-del" class="js-img-del" value=""/>',str+="\t\t</div>",str+="\t\t</td>",str+='\t\t\t<td class="pe-imagesearch-td-wrapper">',str+='\t\t\t\t<div class="pe-imagesearch-btn">',str+='\t\t\t\t\t<img src="https://tilda.ws/img/linea/basic_magnifier.svg" style="padding:10px" width="20px">',str+='\t\t\t\t\t<span style="vertical-align: middle">'+("RU"==window.lang?"Искать в библиотеке":"Search photos")+"</span>",str+="\t\t\t\t</div>",str+="\t\t\t</td>",str+="\t\t</tr>",str+="\t\t</table>",str+="\t\t<br><br>",str+='\t\t<div class="js-img-card js-'+field+'-div" style="display:'+(""!=value?"block":"none")+';">',str+='\t\t\t<table class="pe-imagebox__tabel">',str+='\t\t\t<tr class="pe-imagebox__tr">',str+='\t\t\t<td class="pe-imagebox__td pe-imagebox__td-thumb"><img src="'+value+'" class="pe-imagebox__img" width="135" id="rec'+data.record.id+field+'id" style="max-height:300px;"></td>',str+='\t\t\t<td class="pe-imagebox__td pe-imagebox__td-name" style="padding-left:20px; padding-right:20px; width:500px; font-size:12px; color:#333;" id="'+field+'-name"><a href="'+value+'" target="_blank" class="js-img-title" data-img-href="">... '+value.slice(-30)+"</a></td>",-1!==data.tpl.fields.indexOf(field+"_alt")&&(str+='\t\t\t<td class="pe-imagebox__td" style="white-space: nowrap;"><span class="js-edrec-img-showmore" style="cursor:pointer;">...</span>&nbsp;&nbsp;&nbsp;&nbsp;</td>'),-1===value.indexOf(".svg")&&(str+='\t\t\t<td class="pe-imagebox__td" style="white-space: nowrap; padding-right: 10px;"><a href="javascript:tui_editimage('+data.record.id+",'rec"+data.record.id+field+'id\');" id="rec'+data.record.id+"edit"+field+'item" class="js-edit-img"><span class="glyphicon glyphicon-pencil"></span></a></td>'),str+='\t\t\t<td class="pe-imagebox__td"><span class="js-edrec-img-delbtn glyphicon glyphicon-trash" style="cursor:pointer;"></span></td>',str+="\t\t\t</tr>",str+="\t\t\t</table>",str+='\t\t\t<div class="js-img-more" style="display:none;" id="rec'+data.record.id+field+'_more">',str+='\t\t\t\t<br><label class="pe-label">'+("RU"==window.lang?"SEO: Альт-текст для изображения":"SEO: Image alt text")+"</label>",str+='\t\t\t\t<input type="text" name="'+field+'_alt" class="pe-input js-img-alt" value="'+(void 0!==data.record[field+"_alt"]?data.record[field+"_alt"]:"")+'">',str+="\t\t\t</div>",str+="\t\t</div>",str+="\t</div>",str+='\t<div class="pe-hint"></div>',str+="</div>",wrapper.append(str);var wrappgroup=wrapper.find('.pe-form-group[data-tpl-field="'+field+'"]');wrappgroup.find(".pe-imagesearch-btn").click((function(){var tu=$("#tuwidget"+data.record.id+field).data("tildaupload");openImageSearchPopup(tu,"rec"+data.record.id+field+"id")})),wrappgroup.find("[name="+field+"-tubutton]").each((function(){var $this=$(this),elementid=$this.attr("id");elementid||(elementid="tuwidget"+parseInt(Math.floor(Math.random()*(9e5+1))+99999),$this.attr("id",elementid)),TUWidget.init($this).done((function(file){if(void 0!==file.tuInfo){var box=wrapper.find(".js-image-box__"+field);box.find("#rec"+data.record.id+field+"id").attr("src",file.tuInfo.cdnUrl),box.find("#"+field+"-name").html('<a href="'+file.tuInfo.cdnUrl+'" target="_blank" class="js-img-title">... '+file.tuInfo.name+"</a>"),box.find("[name="+field+"-tuinfo-uuid]").val(file.tuInfo.uuid),box.find("[name="+field+"-tuinfo-cdnurl]").val(file.tuInfo.cdnUrl),box.find("[name="+field+"-tuinfo-name]").val(file.tuInfo.name),box.find("[name="+field+"-tuinfo-width]").val(file.tuInfo.width),box.find("[name="+field+"-tuinfo-height]").val(file.tuInfo.height),-1===file.tuInfo.name.indexOf(".svg")?box.find(".js-edit-img").css("display","inline"):box.find(".js-edit-img").css("display","none"),box.find(".js-img-card").css("display","block"),setTimeout((function(){$("#"+elementid+"-previews").removeClass("tu-popup-progressbar-completed").removeClass("tu-processing").removeClass("tu-image-preview").removeClass("tu-success").removeClass("tu-complete").addClass("tu-popup-progressbar-start")}),3e3)}})).fail((function(file,message){}))})),wrappgroup.find(".js-edrec-img-delbtn").click((function(){var el=$(this).closest(".js-image-box");el.find(".js-img-card").css("display","none"),el.find(".js-img-del").val("yes"),el.find(".js-img-alt").val("")})),wrappgroup.find(".js-edrec-img-showmore").click((function(){var el=$(this).closest(".js-image-box").find(".js-img-more");"block"==el.css("display")?el.css("display","none"):el.css("display","block")}))}function edrec__drawUI__screen(ui,value,data,field,wrapper){if("screenmin"!=field){var str="";str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='    <label class="pe-label">'+ui.label+"</label>",str+='\t<div id="screen-slider-range"></div>',str+='\t<div id="screen-slider-graph"></div>',str+='\t<div id="screen-slider-text"></div>',str+='\t<input type="hidden" id="screen_start" name="screenmin">',str+='\t<input type="hidden" id="screen_end" name="screenmax">',str+="</div>",wrapper.append(str);var screen_init_min=screenslider_converval(data.record.screenmin),screen_init_max=screenslider_converval(data.record.screenmax);""==screen_init_min&&(screen_init_min="1"),""==screen_init_max&&(screen_init_max="7"),$("#screen-slider-range").slider({range:!0,min:1,max:7,step:1,values:[screen_init_min,screen_init_max],slide:function(event,ui){screenslider_do(ui.values[0],ui.values[1])}}),screenslider_do($("#screen-slider-range").slider("values",0),$("#screen-slider-range").slider("values",1))}function screenslider_do(v1,v2){var start=screenslider_getval(v1),end=screenslider_getval(v2);$("#screen_start").val(start),$("#screen_end").val(end),1!=v1&&7!=v1||$("#screen_start").val(""),1!=v2&&7!=v2||$("#screen_end").val("");var end_text="&#8804; "+end;7==v2&&(end_text=end),$(".ui-slider-handle").first().html("<div class='ui-slider-helper'>&#62; "+start+"</div>"),$(".ui-slider-handle").last().html("<div class='ui-slider-helper' style='left:-48px;'>"+end_text+"</div>")}function screenslider_getval(v){var vv="";return 1==v&&(vv="0px"),2==v&&(vv="320px"),3==v&&(vv="480px"),4==v&&(vv="640px"),5==v&&(vv="980px"),6==v&&(vv="1200px"),7==v&&(vv="Max"),vv}function screenslider_converval(v){var vv="";return"0px"==v&&(vv=1),"320px"==v&&(vv=2),"480px"==v&&(vv=3),"640px"==v&&(vv=4),"980px"==v&&(vv=5),"1200px"==v&&(vv=6),"Max"==v&&(vv=7),vv}}function edrec__drawUI__Link(ui,value,data,field,wrapper){var str="";str+='<div class="pe-form-group pe-form-group-field-'+field+'" data-tpl-field="'+field+'">',str+="</div>",wrapper.append(str);var link=value,linktarget="",showlinktarget="",foo;"link"==field&&(foo="linktarget"),"link2"==field&&(foo="linktarget2"),"link3"==field&&(foo="linktarget3"),"link4"==field&&(foo="linktarget4"),"link5"==field&&(foo="linktarget5"),"link6"==field&&(foo="linktarget6"),"link7"==field&&(foo="linktarget7"),"link8"==field&&(foo="linktarget8"),"buttonlink"==field&&(foo="buttonlinktarget"),"buttonlink2"==field&&(foo="buttonlinktarget2"),"buttonlink3"==field&&(foo="buttonlinktarget3"),"buttonlink4"==field&&(foo="buttonlinktarget4"),"buttonlink5"==field&&(foo="buttonlinktarget5"),"buttonlink6"==field&&(foo="buttonlinktarget6"),"buttonlink7"==field&&(foo="buttonlinktarget7"),"buttonlink8"==field&&(foo="buttonlinktarget8"),"bbuttonlink"==field&&(foo="bbuttonlinktarget"),void 0!==data.record[foo]&&(linktarget=data.record[foo]);var temp=data.tpl.fields;""!=temp&&(temp=temp.replace("alllinktarget,","")),-1===temp.indexOf(foo+",")&&-1===temp.indexOf(","+foo)||(showlinktarget="yes"),link=(link=(link=link.replace("\\","")).replace("\\","")).replace("\\",""),"link"==field&&"y"==data.code_restricted?(str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',str+='<label class="pe-label">'+ui.label+"</label>",str+='<div style="background-color:yellow; padding:20px; color:#000;">',str+="RU"==lang?"Доступ к этому блоку ограничен. Пожалуйста, подтвердите: ":"Access to this block is restricted. Please verify your: ","y"==data.needverify_email&&(str+=' &#183; <a href="/identity/" style="color:#ff855d !important; font-weight: 600;" target="_blank">'+("RU"==lang?"ваш email":"email address")+"</a>"),"y"==data.needverify_phone&&(str+=' &#183; <a href="/identity/sms/" style="color:#ff855d !important; font-weight: 600;" target="_blank">'+("RU"==lang?"номер телефона":"phone number")+"</a>"),str+="</div>",str+="</div>",wrapper.append(str)):"link"==field&&"266"==data.record.tplid?(str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',str+='<label class="pe-label">'+ui.label+"</label>",str+="<div>",str+='<input type="text" name="'+field+'" class="pe-input" placeholder="'+ui.ph+'" value="'+value+'" />',str+='<div class="pe-hint">'+ui.hint+"</div>",str+="</div>",str+="</div>",wrapper.append(str)):edlink__drawUI__Link(field,link,showlinktarget,linktarget)}function edrec__drawUI__special(ui,value,data,field,wrapper){var str="";if(void 0!==ui.uphint?"object"==typeof ui.uphint&&"undefined"!=ui.uphint[lang]&&""!=ui.uphint[lang]&&(ui.uphint=ui.uphint[lang]):ui.uphint="","list"==field&&(void 0===data.record.list&&(data.record.list=""),void 0===data.tpl.lifields&&(data.tpl.lifields=""),str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',str+='<textarea class="editlist__data" name="'+field+'" rows="2" style="height:100px; width:90%; display:none;">'+data.record.list+"</textarea>",str+='<div class="editlist__loader" style="background-color:#efefef;padding:50px 40px; text-align:center; margin-bottom:10px;">'+("RU"==lang?"Загрузка...":"Loading...")+"</div>",str+='<div class="editlist__wrapper" data-ui-type="edli" data-lfields="'+data.tpl.lifields+'"></div>',str+='<a href="javascript:edli__add()" class="editlist__addbtn" style="font-size:14px; width:720px; font-weight:600; text-align:center; text-transform:uppercase; background-color:#000; color:#fff !important; display:block; padding:20px 0px;">'+("RU"==lang?"Добавить элемент":"Add new item")+"</a><br>",str+="</div>"),"forminputs"==field&&(void 0===data.record.list&&(data.record.list=""),void 0===data.tpl.lifields&&(data.tpl.lifields=""),str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',str+='<div class="editlist__loader" style="background-color:#efefef;padding:50px 40px; text-align:center; margin-bottom:10px;">'+("RU"==lang?"Загрузка...":"Loading...")+"</div>",str+='<textarea class="editlist__data" name="'+field+'" rows="2" style="height:100px; width:90%; display:none;">'+data.record.list+"</textarea>",str+='<div class="editlist__wrapper" data-ui-type="edfo" data-foparams="'+data.tpl.lifields+'"></div>',str+='<a href="javascript:edfo__add()" class="pe-form-group-add-button" style="font-size:14px; width:720px; font-weight:600; text-align:center; text-transform:uppercase; background-color:#000; color:#fff !important; display:block; padding:20px 0px;">'+("RU"==lang?"Добавить поле для ввода":"Add input field")+"</a><br>",str+="</div>"),"menuitems"==field&&(str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',str+='<label class="pe-label">'+ui.label+"</label>",str+='<div class="pe-hint" style="padding-bottom:20px;">'+ui.uphint+"</div>",str+='<div id="menuitemscheckboxes'+data.record.id+'" class="pe-menuitems-wrapper">',str+="</div>",str+='<div style="padding-top:10px;">',str+='<a href="javascript:edme__addNewMenuItem();" style="display:block;cursor:copy; padding:10px 40px; background-color:#000; color:#fff !important; display: inline-block;">'+("RU"==lang?"Добавить пункт меню":"Add menu item")+"</a> ","258"!=data.record.tplid&&"456"!=data.record.tplid&&"454"!=data.record.tplid&&"462"!=data.record.tplid&&"770"!=data.record.tplid&&"230"!=data.record.tplid&&"257"!=data.record.tplid&&"446"!=data.record.tplid&&"461"!=data.record.tplid&&"481"!=data.record.tplid&&"309"!=data.record.tplid&&"327"!=data.record.tplid&&"450"!=data.record.tplid&&"451"!=data.record.tplid&&"830"!=data.record.tplid&&"883"!=data.record.tplid&&"967"!=data.record.tplid&&"978"!=data.record.tplid||(str+='&nbsp;&nbsp; <a href="javascript:edme__showUIsubmenu();" style="display:block;cursor:copy; padding:10px 40px; display: inline-block;">'+("RU"==lang?"Добавить пункты второго уровня":"Add subitems")+"</a>"),str+="</div>",str+='<input type="hidden" name="menuitems-editor" value="">',str+="</div>"),"pageslist"==field)if(void 0===data.record.pageslist&&(data.record.pageslist=""),""!=data.record.pageslist||258!=data.record.tplid&&456!=data.record.tplid&&454!=data.record.tplid&&462!=data.record.tplid&&230!=data.record.tplid&&257!=data.record.tplid&&446!=data.record.tplid&&461!=data.record.tplid&&481!=data.record.tplid&&309!=data.record.tplid&&327!=data.record.tplid&&450!=data.record.tplid&&451!=data.record.tplid&&466!=data.record.tplid&&398!=data.record.tplid&&607!=data.record.tplid){str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',str+='<div id="pageslistcheckboxes'+data.record.id+'" class="js-pageslistcheckboxes">',str+='<label class="pe-label">'+ui.label+"</label>",str+='<div class="pe-hint">'+ui.uphint+"</div>",str+='<br><a href="javascript:edrec__pageslist__selectall();">'+("RU"==lang?"Выделить/Снять выделение для всех пунктов":"Select/Unselect all items")+"</a><br><br>";var pi_index=0;for(var pi in data.pages){var checked="";for(var zzz in data.record.pageslist)data.pages[pi].id==data.record.pageslist[zzz]&&(checked="checked"),pi_index++;str+='\t<div class="pe-checkbox-box">',str+='\t<label class="pe-label-checkbox">',str+='\t\t<input type="hidden" name="pageslist['+pi_index+']" id="pageslist-inp-'+pi_index+'" value="'+(""!=checked?data.pages[pi].id:"")+'"/>',str+='\t\t<input type="checkbox" name="pageslist-cb['+pi_index+']" '+checked+' id="pageslist-cb-'+pi_index+'" value="'+data.pages[pi].id+'" class="chbx">&nbsp;'+data.pages[pi].title,str+="\t</label>",str+='\t<script type="text/javascript">',str+='\t\t$("#pageslist-cb-'+pi_index+'").change(function(){',str+='\t\t\tvar tempv=$(this).is(":checked");',str+='\t\t\tif(tempv){tempv=$(this).val();}else{tempv="";}',str+='\t\t\t$("#pageslist-inp-'+pi_index+'").val(tempv);',str+="\t\t});",str+="\t<\/script>",str+="\t</div>"}str+="</div>",str+="</div>",window.edrec__pageslist__selectall=function(){var wrp,els=$(".js-pageslistcheckboxes").find(".chbx");if(void 0!==els&&els.length){var flag_on=0,flag_off=0;els.each((function(){var el;!0===$(this).is(":checked")?flag_on=1:flag_off=1})),1==flag_on&&1==flag_off?els.each((function(){var el=$(this);!1===el.is(":checked")&&el.click()})):els.click()}}}else;if("sharebuttons"==field&&(void 0===data.record.sharefacebook&&(data.record.sharefacebook=""),void 0===data.record.sharevk&&(data.record.sharevk=""),void 0===data.record.sharetwitter&&(data.record.sharetwitter=""),void 0===data.record.shareok&&(data.record.shareok=""),str+="<div>",str+='<label class="pe-label">'+ui.label+"</label>",str+="<br>",str+='<div class="pe-checkbox-box">',str+='<label class="pe-label-checkbox">',str+='\t<input type="hidden" name="sharefacebook" value="'+data.record.sharefacebook+'"/>',str+='\t<input type="checkbox" name="sharefacebook-cb" '+("on"==data.record.sharefacebook?"checked":"")+' class="chbx">&nbsp;Facebook share button',str+="</label>",str+="</div>",str+='<div class="pe-checkbox-box">',str+='<label class="pe-label-checkbox">',str+='\t<input type="hidden" name="sharevk" value="'+data.record.sharevk+'"/>',str+='\t<input type="checkbox" name="sharevk-cb" '+("on"==data.record.sharevk?"checked":"")+' class="chbx">&nbsp;VK share button',str+="</label>",str+="</div>",str+='<div class="pe-checkbox-box">',str+='<label class="pe-label-checkbox">',str+='\t<input type="hidden" name="sharetwitter" value="'+data.record.sharetwitter+'"/>',str+='\t<input type="checkbox" name="sharetwitter-cb" '+("on"==data.record.sharetwitter?"checked":"")+' class="chbx">&nbsp;Twitter share button',str+="</label>",str+='<div class="pe-hint" style="font-size:11px; opacity:0.5;padding-top:0;">'+("RU"==lang?"Твиттер больше не поддерживает API с количеством публикаций. Cчетчик публикаций отображаться не будет":"Twitter no longer supports the API number of publications. Counter publications will not be displayed.")+"</div>",str+="</div>",str+="</div>","RU"==lang&&"806"!=data.record.tplid&&(str+='<div class="pe-checkbox-box">',str+='<label class="pe-label-checkbox">',str+='\t<input type="hidden" name="shareok" value="'+data.record.shareok+'"/>',str+='\t<input type="checkbox" name="shareok-cb" '+("on"==data.record.shareok?"checked":"")+' class="chbx">&nbsp;OK share button',str+="</label>",str+="</div>")),"gallery"==field&&(str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',str+="</div>"),"mapmarkers"==field&&(str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',str+='<label class="pe-label">'+ui.label+"</label>",str+="</div>"),"gallery_insta"==field&&(str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'"></div>'),"formaction"==field&&edrec__drawUI__formaction(data,wrapper),"formmsgsuccess"==field&&(706==data.record.tplid&&void 0!==data.userpaysystems&&null!=data.userpaysystems?(str+='<div class="form-group pe-form-group '+(1==data.record.formactiontype?"hidden":"")+' js-formmsgsuccess" data-tpl-field="'+field+'">',str+='\t<label class="pe-label">'+ui.label+"</label>",str+='\t<div class="padding-top:15px;">',str+="RU"==lang?'Задать текст сообщения об успехе вы можете в <a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_payments" target="_blank" style="color:#fa633f;">настройках платежных систем</a>':'Success message can be edited in Site Settings - <a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_payments" target="_blank" style="color:#fa633f;">Payment systems</a>',str+="\t</div>",str+="</div>"):(str+='<div class="form-group pe-form-group '+(1==data.record.formactiontype?"hidden":"")+' js-formmsgsuccess" data-tpl-field="'+field+'">',str+='\t<label class="pe-label">'+ui.label+"</label>",str+='\t<div class="">',str+='\t\t<div class="pe-redactor">',str+='\t\t\t<textarea name="formmsgsuccess" class="pe-textarea" rows="2" redaktormin="yes" placeholder="'+ui.ph+'">'+value+"</textarea>",str+="\t\t</div>",str+="\t</div>",str+="</div>",str+="<style>",str+="\t.pe-form-group .redactor-linebreaks.redactor-placeholder:after{",str+="\t\ttop:20px;",str+="\t\tleft:0px;",str+="\t\tfont-weight: inherit !important;",str+="\t\tcolor: #cacaca;",str+="\t}",str+="</style>")),"formmsgurl"==field&&(706==data.record.tplid&&void 0!==data.userpaysystems&&null!=data.userpaysystems?(str+='<div class="pe-form-group '+(1==data.record.formactiontype?"hidden":"")+' js-formmsgsuccess" data-tpl-field="'+field+'">',str+='\t<label class="pe-label">'+ui.label+"</label>",str+='\t<div class="padding-top:15px;">',str+="RU"==lang?'Задать URL успеха вы можете в <a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_payments" target="_blank" style="color:#fa633f;">настройках платежных систем</a>':'Success URL can be edited in Site Settings - <a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_payments" target="_blank" style="color:#fa633f;">Payment systems</a>',str+="\t</div>",str+="</div>"):(str+='<div class="pe-form-group '+(1==data.record.formactiontype?"hidden":"")+' js-formmsgsuccess" data-tpl-field="'+field+'">',str+='\t<label class="pe-label">'+ui.label+"</label>",str+='\t<div class="">',str+='\t\t<input type="text" name="formmsgurl" class="pe-input" value="'+value+'" placeholder="'+ui.ph+'">',str+="\t</div>",str+='\t<div class="pe-hint">'+ui.hint+"</div>",str+="</div>")),"lang"!=field&&"lang2"!=field||(void 0===data.record.lang&&(data.record.lang=""),void 0===data.record.lang2&&(data.record.lang2=""),void 0===data.record.langlink&&(data.record.langlink=""),void 0===data.record.lang2link&&(data.record.lang2link=""),str+='<div class="pe-form-group">',str+='\t<label class="pe-label">'+ui.label+"</label>",str+='\t<br><div class="">',str+='\t\t<table class="pe-table">',str+="\t\t<tr>",str+='\t\t<td class="pe-table-col1">',str+="\t\t"+("RU"==lang?"Заголовок":"Title")+"<br>",str+='\t\t<input type="text" name="'+field+'" class="pe-input" value="'+("lang"==field?data.record.lang:data.record.lang2)+'" placeholder="'+ui.ph+'">',str+="\t\t</td>",str+='\t\t<td class="pe-table-col2">',str+="\t\t"+("RU"==lang?"Ссылка":"Link")+"<br>",str+='\t\t<input type="text" name="'+("lang"==field?"langlink":"lang2link")+'" class="pe-input" value="'+("lang"==field?data.record.langlink:data.record.lang2link)+'" placeholder="">',str+="\t\t</td>",str+="\t\t</tr>",str+="\t\t</table>",str+="\t</div>",str+="</div>"),"code"==field&&(str+='<div class="form-group pe-form-group" data-tpl-field="'+field+'">',"y"==data.code_restricted?(str+='<div style="background-color:yellow; padding:20px; color:#000;">',str+="RU"==lang?"Доступ к этому блоку ограничен. Пожалуйста, подтвердите: ":"Access to this block is restricted. Please verify your: ","y"==data.needverify_email&&(str+=' &#183; <a href="/identity/" style="color:#ff855d !important; font-weight: 600;" target="_blank">'+("RU"==lang?"ваш email":"email address")+"</a>"),"y"==data.needverify_phone&&(str+=' &#183; <a href="/identity/sms/" style="color:#ff855d !important; font-weight: 600;" target="_blank">'+("RU"==lang?"номер телефона":"phone number")+"</a>"),str+="</div>"):(str+='<label class="pe-label">'+ui.label+"</label>",str+='<br><div class="">',str+='<pre id="aceeditor'+data.record.id+'">'+value+"</pre>",str+='<textarea name="code" class="js-aceeditor" rows="10" style="opacity:0; height: 1px;">'+value+"</textarea>",str+="</div>"),str+="</div>"),"aliasrecord"==field&&(str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='\t<label class="pe-label">'+ui.label+"</label>",str+='\t<div class="">',str+='\t\t<input type="text" name="'+field+'" class="pe-input" value="'+value+'" placeholder="'+ui.ph+'">',str+="\t</div>",void 0!==data.record.aliasparentpageid&&data.record.aliasparentpageid>0&&(str+='<div class="pe-hint">',data.record.aliasparentpageid==data.record.pageid?str+="RU"==lang?"Блок находится на текущей странице":"The block is on the current page":str+='<a href="/page/?pageid='+data.record.aliasparentpageid+"#rec"+value+'" target="_blank">'+("RU"==lang?"Перейти к родительской странице":"Go to parent page")+"</a>",str+="</div>"),str+="</div>"),"linkhook"==field&&(str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='\t<label class="pe-label">',"398"==data.record.tplid||"303"==data.record.tplid||"794"==data.record.tplid?str+="RU"==lang?"Ссылка для привязки":"Link hook":str+="RU"==lang?"Ссылка на popup":"Popup link",str+="\t</label>","354"!=data.record.tplid&&"367"!=data.record.tplid&&(str+='<p style="font-family:Georgia; color:#444; margin-top:4px; margin-bottom:8px; font-weight:normal; font-size:14px;">',"398"==data.record.tplid||"303"==data.record.tplid||"794"==data.record.tplid?str+="<i>"+("RU"==lang?"укажите точный адрес ссылки, к которой должна быть привязка":"insert a name of the link to which you want to connect this block")+"</i>":str+="<i>"+("RU"==lang?"используйте как ссылку в любом блоке, по клику на который должен показываться этот попап":"Use as a link in any block, to show this popup")+"</i>",str+="</p>"),str+='<div class="">',str+='<input type="text" name="linkhook" class="pe-input" value="'+value+'">',str+="</div>",str+='<div class="pe-hint">'+ui.hint+"</div>",str+="</div>"),"storepart"==field){if(void 0!==data.record.storepart&&null!=data.record.storepart||(data.record.storepart=""),str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='\t<label class="pe-label">'+ui.label+"</label>",str+='\t<div style="width:100%;" class="pe-select">',str+='\t<select class="pe-input pe-select" name="storepart">',951==data.record.tplid?str+='<option value="">'+("RU"==lang?"Каталог-пример":"Example Catalog")+"</option>":str+='<option value="">'+("RU"==lang?"Не задан. (Показывать товары из блока)":"Not set (show products from block)")+"</option>","object"==typeof data.storeparts)for(var ii in data.storeparts)str+='<option value="'+data.storeparts[ii].uid+'" '+(data.storeparts[ii].uid==data.record.storepart?'selected="selected"':"")+">"+("y"==data.storeparts[ii].root?"RU"==lang?"Все товары из каталога":"All products":("RU"==lang?"Раздел: ":"Part: ")+data.storeparts[ii].title)+"</option>";str+="\t</select>",str+="\t</div>",str+='\t<div class="pe-hint">',"object"==typeof data.storeparts&&data.record.storepart>0?str+="RU"==lang?'Перейти в <a href="/identity/gostore/?projectid='+data.projectid+'" target="_blank" '+("object"!=typeof data.storeparts?'onclick="edrec__closeEditForm()"':"")+">каталог товаров</a>":'Go to the <a href="/identity/gostore/?projectid='+data.projectid+'" target="_blank" '+("object"!=typeof data.storeparts?'onclick="edrec__closeEditForm()"':"")+">products catalog</a>":str+="RU"==lang?'Если у вас много товаров, для управления ими используйте <a href="/identity/gostore/?projectid='+data.projectid+'" target="_blank" '+("object"!=typeof data.storeparts?'onclick="edrec__closeEditForm()"':"")+">каталог товаров</a>":'If you have a lot of products, use the <a href="/identity/gostore/?projectid='+data.projectid+'" target="_blank" '+("object"!=typeof data.storeparts?'onclick="edrec__closeEditForm()"':"")+">products catalog</a> to manage them.",str+="\t</div>",str+="</div>"}if("feedpart"==field){if(void 0!==data.record.feeds&&null!=data.record.feeds||(data.record.feedspart=""),str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='\t<label class="pe-label">'+ui.label+"</label>",str+='\t<div style="width:100%;" class="pe-select">',str+='\t<select class="pe-input pe-select" name="feedpart">',str+='\t\t<option value="">'+("RU"==lang?"Не задан":"Not set)")+"</option>","5d9725a245f86259476957"!=data.record.feedpart&&"5d971e17b674f464032195"!=data.record.feedpart||(str+='<option value="'+data.record.feedpart+'" selected="selected">'+("RU"==lang?"Поток-пример":"Example Feed")+"</option>"),"object"==typeof data.feeds)for(var ii in data.feeds)if(str+='<option value="'+data.feeds[ii].uid+'" '+(data.feeds[ii].uid==data.record.feedpart?'selected="selected"':"")+">"+("RU"==lang?"Поток: ":"Feed: ")+data.feeds[ii].title+"</option>","object"==typeof data.feeds[ii].parts)for(var iii in data.feeds[ii].parts){var partuid=data.feeds[ii].uid+"-"+data.feeds[ii].parts[iii].uid;str+='<option value="'+partuid+'" '+(partuid==data.record.feedpart?'selected="selected"':"")+">"+("RU"==lang?"--- Раздел: ":"--- Part: ")+data.feeds[ii].parts[iii].title+"</option>"}str+="\t</select>",str+="\t</div>",str+='\t<div class="pe-hint">',"object"==typeof data.feeds&&data.record.feedpart>0?str+="RU"==lang?'Перейти в <a href="/identity/gofeeds/?projectid='+data.projectid+'" target="_blank" '+("object"!=typeof data.feeds?'onclick="edrec__closeEditForm()"':"")+">управление потоками</a>":'Go to the <a href="/identity/gofeeds/?projectid='+data.projectid+'" target="_blank" '+("object"!=typeof data.feeds?'onclick="edrec__closeEditForm()"':"")+">feeds edit panel</a>":str+="RU"==lang?'Используйте потоки, чтобы вести ленту новостей, блог или другую ленту событий. Перейти в <a href="/identity/gofeeds/?projectid='+data.projectid+'" target="_blank" '+("object"!=typeof data.feeds?'onclick="edrec__closeEditForm()"':"")+">управление потоками</a>":'To post a news feed, blog, or other news feed. Use <a href="/identity/gofeeds/?projectid='+data.projectid+'" target="_blank" '+("object"!=typeof data.feeds?'onclick="edrec__closeEditForm()"':"")+">feeds panel</a> to manage them.",str+="\t</div>",str+="</div>"}if("recids"!=field&&"recids2"!=field&&"recids3"!=field&&"recids4"!=field&&"recids5"!=field&&"recids6"!=field&&"recids7"!=field&&"recids8"!=field||(str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='<div class="pe-form-group-field-'+field+'">',str+='<script type="text/javascript">',str+='edlink__drawUI__Recids("'+field+'","'+value+'");',str+="<\/script>",str+="</div>",str+="</div>"),"paymentstat"==field&&(str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='    <div class="pe-hint" style="padding:0;">',str+=("RU"==lang?"Отправка корзины, в системе аналитики, будет отображаться, как просмотр страницы: ":"You can setup cart data submission as a goal in the analytic system as a view of virtual page: ")+"<br>/tilda/form"+data.record.id+"/submitted/ "+("RU"==lang?"или":"or")+"<br>/tilda/form"+data.record.id+"/payment/<br>FB pixel: 'Lead' event",str+="\t</div>",str+="</div>"),"formstat"==field&&(str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='    <div class="pe-hint" style="padding:0;">',str+=("RU"==lang?"Отправка формы в системе аналитики будет отображаться как просмотр страницы: ":"You can setup form submission as a goal in the analytic system as a view of virtual page: ")+"/tilda/form"+data.record.id+"/submitted<br>FB pixel: 'Lead' event",str+="\t</div>",str+="</div>"),"makefish"==field&&(str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='<div class="pe-checkbox-box"><label class="pe-label-checkbox">',str+=data.record.id==data.tpl.fishid?"This is a fish":'<input type="checkbox" name="makefish"> Make fish',str+="</label></div><br><br>",str+="</div>"),"makezerofish"==field){for(var ii in str+='<div class="pe-form-group" data-tpl-field="'+field+'">',str+='<label class="pe-label">Make Zero Fish for Block</label>',str+='<div class="pe-select">',str+='<select class="pe-input pe-select" name="setzero_tplid">',str+='<option value="">None</option>',data.zalltpls)str+='<option value="'+data.zalltpls[ii].id+'" '+(data.record.id==data.zalltpls[ii].zeroid?'selected="selected"':"")+">"+data.zalltpls[ii].cod+": "+data.zalltpls[ii].title+"</option>";str+="</select>",str+="</div>",str+="</div>"}if("oklink"!=field){if(wrapper.append(str),"list"==field&&(window.lireplaces="",void 0!==data.tpl.lireplaces&&""!=data.tpl.lireplaces&&(window.lireplaces=JSON.parse(data.tpl.lireplaces)),setTimeout((function(){edli__init(),$(".editlist__loader").remove()}),400)),"forminputs"==field&&(window.lireplaces="",void 0!==data.tpl.lireplaces&&""!=data.tpl.lireplaces&&(window.lireplaces=JSON.parse(data.tpl.lireplaces)),setTimeout((function(){edfo__init(),$(".editlist__loader").remove()}),400)),"menuitems"==field){var lid=0,items=data.record.menuitems?JSON.parse(data.record.menuitems):[];for(var pi in items){if(edme__addItem(items[pi].title,items[pi].link,items[pi].linktarget,lid),void 0!==items[pi].sub){var wrp=edme__addSubWrapper(lid),sublid=0;for(var si in items[pi].sub)edme__addSubItem(wrp,items[pi].sub[si].title,items[pi].sub[si].link,items[pi].sub[si].linktarget,lid,sublid),sublid++;edme__addSortable_sub(lid)}lid++}edme__addSortable()}if("sharebuttons"==field&&($("input[name=sharefacebook-cb]").change((function(){var tempv=$(this).is(":checked");tempv=tempv?"on":"",$("input[name=sharefacebook]").val(tempv)})),$("input[name=sharetwitter-cb]").change((function(){var tempv=$(this).is(":checked");tempv=tempv?"on":"",$("input[name=sharetwitter]").val(tempv)})),$("input[name=sharevk-cb]").change((function(){var tempv=$(this).is(":checked");tempv=tempv?"on":"",$("input[name=sharevk]").val(tempv)})),$("input[name=shareok-cb]").change((function(){var tempv=$(this).is(":checked");tempv=tempv?"on":"",$("input[name=shareok]").val(tempv)}))),"gallery_insta"==field&&edinst__init(),"gallery"==field&&edga__init(data,wrapper),"mapmarkers"==field&&edmap__init(data,wrapper),"userpayment"==field){-1!==data.tpl.fields.indexOf(field)&&(str+='<div class="pe-form-group" data-tpl-field="paymentoff">',str+='\t<div class="pe-checkbox-box">',str+='\t<label class="pe-label-checkbox">',str+='\t\t<input type="hidden" name="paymentoff" value="'+(void 0!==data.record.paymentoff?data.record.paymentoff:"")+'"/>',str+='\t\t<input type="checkbox" name="paymentoff-cb" '+("y"==data.record.paymentoff?"checked":"")+' class="chbx">',str+="\t\t\t"+("RU"==lang?"Выключить оплату":"Disable payment"),str+="\t</label>",str+="\t</div>",str+="</div>",wrapper.append(str),$("input[name=paymentoff-cb]").change((function(){var tempv=$(this).is(":checked");tempv?(tempv="y",$(".js-payment-option").hide(),$("input[name=formmsgurl]").length>0&&$("input[name=formmsgurl]").closest(".pe-form-group").fadeIn()):(tempv="",$(".js-payment-option").show(),$("input[name=formmsgurl]").length>0&&$("input[name=formmsgurl]").closest(".pe-form-group").fadeOut()),$("input[name=paymentoff]").val(tempv)})),"y"==$("input[name=paymentoff]").val()?($(".js-payment-option").hide(),$("input[name=formmsgurl]").length>0&&$("input[name=formmsgurl]").closest(".pe-form-group").show()):$("input[name=formmsgurl]").length>0&&$("input[name=formmsgurl]").closest(".pe-form-group").hide());var str="";if(str+='<div class="pe-form-group js-payment-option" data-tpl-field="'+field+'">',str+='\t<input type="hidden" name="userpayment" value="y">',void 0!==data.userpaysystems&&data.userpaysystems&&data.userpaysystems.length>0){for(var key in 1==data.userpaysystems.length?str+='<label class="pe-label">'+("RU"==lang?"Установлена платежная система:":"Installed payment system:")+"</label>":str+='<label class="pe-label">'+("RU"==lang?"Установлены платежные системы:":"Installed payments systems:")+"</label>",str+='<div style="padding-top: 10px;">',str+="\t<ul>",data.userpaysystems){var upay=data.userpaysystems[key];void 0===upay.system&&(upay.system=""),void 0===upay.accountid&&(upay.accountid=""),void 0===upay.type&&(upay.type=""),void 0===upay.currency&&(upay.currency=""),void 0===upay.title&&(upay.title=""),str+="<li>",""!=upay.title?str+=upay.title:"paypal"==upay.system?str+="Paypal: "+upay.accountid+", "+upay.currency+" ("+("_donations"==upay.type?"Donate":"Buy")+")":"yamoney"==data.project.upay.system?str+="Yandex.Money: "+upay.accountid+", "+upay.currency+" ("+("donate"==upay.type?"Donate":"Buy")+")":"yamoneymc"==data.project.upay.system?str+="Yandex.Money: "+upay.accountid+", Mobile ("+("_donations"==upay.type?"Donate":"Buy")+")":"yamoneyac"==data.project.upay.system?str+="Yandex.Money: "+upay.accountid+", Credit Card ("+("_donations"==upay.type?"Donate":"Buy")+")":"yamoneypc"==data.project.upay.system?str+="Yandex.Money: "+upay.accountid+", Yandex Money ("+("_donations"==upay.type?"Donate":"Buy")+")":"yakassa"==upay.system?str+="Yandex.Kassa: "+upay.accountid+", "+upay.currency:"stripe"==upay.system?str+="Stripe: "+upay.accountid+", "+upay.currency:"cloudpayments"==upay.system?str+="CloudPayments: "+upay.accountid+", "+upay.currency:"robokassa"==upay.system?str+="Robokassa: "+upay.accountid+", "+upay.currency:"liqpay"==upay.system?str+="LiqPay: "+upay.accountid+", "+upay.currency:str+=upay.system+", "+upay.accountid,str+="</li>"}str+="\t</ul>",str+='\t\t <a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_payments" style="color: #ff8562 !important;">'+("RU"==lang?"Настройки":"Settings")+"</a>",str+="</div>"}else str+='<label class="pe-label">&nbsp;</label>',str+="<div>","RU"==lang?str+='Подключите платежную систему в <a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_payments" style="color: #ff8562 !important;">настройках сайта</a>':str+='Please, connect payment system in <a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_payments" style="color: #ff8562 !important;">site settings</a>',str+="</div>";str+="</div>",wrapper.append(str)}if("buttonlink_prod"==field){var str="";str+='<div class="pe-select-div">',str+='<div class="pe-select">',str+='<select class="pe-input pe-select" name="buttonlink_prod">',str+=' <option value="" '+(""==data.record.buttonlink_prod?'selected="selected"':"")+">"+("RU"==lang?"Ссылка":"Link")+"</option>",str+=' <option value="order" '+("order"==data.record.buttonlink_prod?'selected="selected"':"")+">"+("RU"==lang?"Добавить в корзину":"Add to Cart")+"</option>",str+="</select>",str+="</div>",str+="</div>";var linkwrapp=$('[data-tpl-field="buttonlink"]');linkwrapp.find(".pe-label").after(str);var inp=$(".pe-form-group").find('[name="buttonlink_prod"]'),inplink=linkwrapp.find(".pe-field-link").find('[name="buttonlink"]');inp.change((function(){var v=inp.val();"order"==v?linkwrapp.find(".pe-field-link").css("display","none"):linkwrapp.find(".pe-field-link").css("display","block"),"order"==v?inplink.val("#order"):"#order"==inplink.val()&&inplink.val("")})),inp.trigger("change")}if("prod_option"==field&&edrec__drawUI__prodoptions(data,wrapper),"code"==field&&$(document).ready((function(){if($("#aceeditor"+data.record.id).length){var aceeditor=ace.edit("aceeditor"+data.record.id);aceeditor.setTheme("ace/theme/github"),aceeditor.session.setMode("ace/mode/html"),aceeditor.setAutoScrollEditorIntoView(!0),aceeditor.setOption("minLines",10),aceeditor.setOption("maxLines",30),$("#aceeditor"+data.record.id).closest("div").find(".js-aceeditor").data("aceeditor",aceeditor)}})),"linkhook"==field&&$("input[name=linkhook]").change((function(){var tempv=$(this).val();""!=tempv&&/[\u0400-\u04FF]/.test(tempv)&&alert("Please, use only Latin letters in link")})),"storepart"==field&&"object"==typeof data.storeparts){if(""!=data.record.storepart&&$('.pe-form-group[data-tpl-field="list"]').css("display","none"),$(".editlist__data").length>0&&""!=$(".editlist__data").val()){var s="";data.record.storepart;var ss="";ss+='\t<span class="link_copyproductstocatalog">'+("RU"==lang?'<a href="javascript:edrec__copyproducts_to_catalog('+data.record.pageid+","+data.record.id+')" style="color:#fa8669;">Скопировать товары в каталог</a> из данного блока.':'<a href="javascript:edrec__copyproducts_to_catalog('+data.record.pageid+","+data.record.id+')" style="color:#fa8669;">Copy products to catalog</a> from this block.')+"</span>",ss+='\t<span class="link_copyproductstocatalog_result"></span>',$(".editlist__wrapper").parent().prepend(s),$(".editlist__wrapper").parent().append(ss)}setTimeout((function(){}),500)}}else"RU"!=lang&&""==value||edrec__drawUI__input(ui,value,data,field,wrapper)}function edrec__drawUI__converttozero(data,wrapper){var str="";str+='<div style="padding-top:20px;padding-bottom:0px;" class="pe-zero-convert-btn">',str+='\t<table style="max-width:280px; height:50px; border:1px solid rgba(0,0,0,0.1);cursor: pointer; color:#000;" onclick="converttozero('+data.record.id+');">',str+="\t\t<tr>",str+='\t\t\t<td style="padding-left:20px; width:30px; text-align:center;"><img src="/tpl/img/null/zero1_for_small_size_black.svg" style="width:30px;"></td>',str+='\t\t\t<td style="font-size:13px; font-weight:500; line-height:50px; padding-right:20px; padding-left:10px;padding-top:2px;">'+("RU"==lang?"Конвертировать в Zero Block":"Convert to Zero Block")+"</td>",str+="\t\t</tr>",str+="\t</table>",str+='\t<div style="opacity:0.7; font-size:13px; font-weight:300; padding-top:10px;">'+("RU"==lang?"Используйте редактор, чтобы изменить дизайн этого блока. Конвертируйте его в полностью редактируемый Zero Block и управляйте каждым элементом.":"Use the editor to change the design of this block. Convert it to the full editable Zero Block and manage every element")+"</div>",str+="</div>",str+='<div class="pe-zero-convert-notice"></div>',wrapper.append(str)}function edrec__drawUI__formaction(data,wrapper){void 0===data.record.formactiontype&&(data.record.formactiontype=""),void 0===data.record.formaction&&(data.record.formaction=""),void 0===data.record.formtarget&&(data.record.formtarget=""),void 0===data.record.formajax&&(data.record.formajax="");var str="";if(str+='\t<div class="pe-form-group">',str+='\t\t<label class="pe-label pe-label__recievedataforms">'+("RU"==lang?"Прием данных из формы":"Form data receiver")+"</label>",str+="\t\t<br>",str+='\t\t<div class="pe-hint" style="padding:0;">',str+="\t\t"+("RU"==lang?'Отправленные данные будут храниться в <a href="https://tilda.cc/projects/leads/?projectid='+data.projectid+'" target="_blank" style="color:#FF855D !important;">разделе «Заявки»</a>. Также вы можете подключить сервисы приема данных, интегрированных с Тильдой.':'Sent data will be stored in the <a href="https://tilda.cc/projects/leads/?projectid='+data.projectid+'" target="_blank" style="color:#FF855D !important;">Leads section</a> of the website. You can always connect data capture services integrated with Tilda.'),str+="\t\t</div>",str+='\t\t<div class="js-accourdion-wrapper" id="formactionbox'+data.record.id+'">',str+="\t\t\t"+(1!=data.record.formactiontype?'<div style="display:none;" class="pe-wrapper__servicesrecievers">':""),str+='\t\t\t<label class="pe-label-radio"><input type="radio" name="formactiontype'+data.record.id+'" value="2" data-collapse-id="formtype'+data.record.id+'two" '+(1!=data.record.formactiontype?'checked="checked"':"")+"/> "+("RU"==lang?"Контактные листы и сервисы":"Contacts lists and services")+"</label>",str+="\t\t\t"+(1!=data.record.formactiontype?"</div>":""),str+='\t\t\t<div class="js-accourdion-box" style="margin-left: 0; '+(void 0===data.record.formactiontype||""==data.record.formactiontype||"0"==data.record.formactiontype||2==data.record.formactiontype?"display:block;":"display:none;")+'" id="formtype'+data.record.id+'two">',str+="\t\t\t\t<br>",str+='\t\t\t\t<table border="0"><tr valign="top">',$oplan>0){if(str+='\t\t\t\t<td style="padding-right: 30px;" width="49%" class="js-box-tilda-crm-lists">',str+='\t\t\t\t\t<label class="pe-label" style="font-weight: bold; margin-bottom: 20px;">'+(lang,"Tilda CRM:")+"</label>",void 0!==data.formcrmintegrations&&0!=data.formcrmintegrations.length){for(var j in data.formcrmintegrations)str+='\t\t\t\t\t\t<label class="pe-label" style="margin-bottom:12px;"><input type="checkbox" name="formintegrations'+data.record.id+'[]" value="'+data.formcrmintegrations[j].hash+'" '+(1==data.formcrmintegrations[j].checked?'checked="checked"':"")+"> "+data.formcrmintegrations[j].name+"</label>";str+="\t\t\t\t\t\t<br>",str+='\t\t\t\t\t\t<div class="pe-hint" style="padding-top: 0px;">',str+="\t\t\t\t\t\t\t"+("RU"==lang?'Перейти в <a href="https://tilda.cc/identity/gocrm/" target="_blank">Tilda CRM</a>':'Go to <a href="https://tilda.cc/identity/gocrm/" target="_blank">Tilda CRM</a>'),str+="\t\t\t\t\t\t</div>",str+="\t\t\t\t\t\t<br>"}else str+='\t\t\t\t\t<div class="pe-hint" style="margin-bottom: 10px;padding-top: 0px;">',str+="\t\t\t\t\t\t"+("RU"==lang?"У Вас пока нет ни одного листа":"You don't have any list yet."),str+="\t\t\t\t\t</div>",str+='\t\t\t\t\t<a href="https://tilda.cc/identity/gocrm/" target="_blank" class="pe-btn-black" style="color: #ffffff !important; font-weight: 400;border-radius:5px;margin-bottom:25px;padding:8px 20px;">'+("RU"==lang?"Создать":"Create")+"</a>";str+="\t\t\t\t</td>"}if(str+='\t\t\t\t<td width="49%" id="outerrecieverboxid">',str+='\t\t\t\t\t<label class="pe-label" style="font-weight: bold; margin-bottom: 20px;">'+("RU"==lang?"Подключенные сервисы":"Connected services")+":</label>",void 0!==data.formintegrations&&data.formintegrations.length>0){for(var j in data.formintegrations)str+='<label class="pe-label" style="margin-bottom:12px;"><input type="checkbox" name="formintegrations'+data.record.id+'[]" value="'+data.formintegrations[j].hash+'" '+(1==data.formintegrations[j].checked?'checked="checked"':"")+'  data-form-type="'+data.formintegrations[j].type+'">',""!=data.formintegrations[j].name?str+=" "+data.formintegrations[j].type+": "+data.formintegrations[j].name:str+=" "+data.formintegrations[j].type+": "+data.formintegrations[j].appid.substr(10),str+="</label>";str+="\t\t\t\t\t\t<br>"}else str+='\t\t\t\t\t\t<div class="pe-hint" style="padding-top: 0px;">'+("RU"==lang?"Вы пока не подключили ни одного сервиса":"You have not connected any service yet")+"</div>",str+="\t\t\t\t\t\t<br>",str+='\t\t\t\t\t\t<a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_forms" class="pe-btn-black" style="color: #ffffff !important; font-weight: 400;border-radius:5px;padding:8px 20px;">'+("RU"==lang?"Подключить":"Connect")+"</a>";str+="\t\t\t\t</td>",str+="\t\t\t\t</tr></table>",str+='\t\t\t\t\t<div class="pe-hint">',"RU"==lang?str+='Вы можете получать данные на Email, в документ Google или в сервисы, интегрированные с Тильдой: MailChimp, GetResponse, UniSender, SendGrid, amoCRM, Мегаплан и другие. Подключите сервис для приема данных в настройках сайта, <a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_forms" target="_blank">раздел Формы</a>. Читайте <a href="https://help-ru.tilda.cc/forms" target="_blank">подробную инструкцию</a> в нашем Справочном центре. '+(void 0!==data.project&&void 0!==data.project.json&&void 0!==data.project.json.formspamguard&&"on"==data.project.json.formspamguard?"<br>Защита от спама включена.":""):str+='You can get data on Email, on Google Docs or to one of many integrated services such as MailChimp, SendGrid, Trello, Slack etc. Assign service in Site Settings > <a href="/projects/settings/?projectid='+data.projectid+'#tab=ss_menu_forms" target="_blank">Forms</a>. Read <a href="https://help.tilda.cc/forms" target="_blank">the detailed instruction</a> in our Help Centre. '+(void 0!==data.project&&void 0!==data.project.json&&void 0!==data.project.json.formspamguard&&"on"==data.project.json.formspamguard?"<br>Anti-spam activated.":""),str+="\t\t\t\t\t</div>",str+="\t\t\t</div>",str+="\t\t\t<br>",str+="\t\t"+(1!=data.record.formactiontype?"<div style='display:none;' class='pe-wrapper__ownscriptreciever'>":""),str+='\t\t\t<label class="pe-label-radio"><input type="radio" name="formactiontype'+data.record.id+'" value="1" data-collapse-id="formtype'+data.record.id+'one" '+(1==data.record.formactiontype?'checked="checked"':"")+"/>",str+="\t\t\t"+("RU"==lang?"Свой скрипт для принятия данных":"Own script for receive data")+"</label>",str+='\t\t\t<div class="js-accourdion-box" style="margin-left: 20px; '+(1==data.record.formactiontype?"display:block;":"display:none;")+'" id="formtype'+data.record.id+'one">',str+='\t\t\t\t<input type="text" name="formaction" class="pe-input" value="'+data.record.formaction+'" placeholder="example: http://site.com/submit.php">',str+='\t\t\t\t<div class="pe-hint">'+("RU"==lang?'Необходимо указать адрес скрипта, который принимает значения из формы. Как настроить прием данных из формы, <a href="https://help-ru.tilda.cc/forms" target="_blank">читайте в разделе Помощь</a>':'Write script address that will receive fields value. <a href="https://help.tilda.cc/forms" target="_blank">Read the Help to learn how to configure</a> data reception from certain fields.')+"</div>",str+="\t\t\t\t<br>",-1!==data.tpl.fields.indexOf(",formtarget")&&(str+='\t\t\t\t<label class="pe-label">'+("RU"==lang?"Цель формы":"Form Target")+"</label>",str+='\t\t\t\t<div class="pe-select">',str+='\t\t\t\t\t<select class="pe-input pe-select" name="formtarget">',str+='\t\t\t\t\t  <option value="" '+(""==data.record.formtarget?'selected="selected"':"")+">"+("RU"==lang?"В этом же окне":"Same window")+"</option>",str+='\t\t\t\t\t  <option value="_blank" '+("_blank"==data.record.formtarget?'selected="selected"':"")+">"+("RU"==lang?"В новом окне":"New Window")+"</option>",str+="\t\t\t\t\t</select>",str+="\t\t\t\t</div>"),str+='\t\t\t\t<div class="pe-checkbox-box">',str+='\t\t\t\t<label class="pe-label-checkbox">',str+='\t\t\t\t\t<input type="hidden" name="formajax" value="'+data.record.formajax+'"/>',str+='\t\t\t\t\t<input type="checkbox" name="formajax-cb" '+("y"==data.record.formajax?"checked":"")+' class="chbx">',str+="\t\t\t\t\t\t"+("RU"==lang?"посылать данные без перезагрузки страницы (AJAX)":"is ajax action script"),str+="\t\t\t\t</label>",str+="\t\t\t\t</div>",str+="\t\t\t</div>",str+="\t\t\t"+(1!=data.record.formactiontype?"</div>":""),str+="\t\t\t<br>",str+="\t\t</div>",str+="\t</div>",wrapper.append(str),$("#formactionbox"+data.record.id).find("input[type=radio]").change((function(){$(this).is(":checked")&&($("#"+$(this).data("collapse-id")).show(),1==$(this).val()?($("#formtype"+data.record.id+"two").hide(),$("#form"+data.record.id).find(".js-formmsgsuccess").addClass("hidden")):($("#formtype"+data.record.id+"one").hide(),$("#form"+data.record.id).find(".js-formmsgsuccess").removeClass("hidden")))})),wrapper.find("input[name=formajax-cb]").change((function(){var tempv=$(this).is(":checked");tempv=tempv?"y":"",$("input[name=formajax]").val(tempv)})),$(".pe-label__recievedataforms").dblclick((function(){$(".pe-wrapper__ownscriptreciever").css("display","block"),$(".pe-wrapper__servicesrecievers").css("display","block")}))}function edrec__settings_showmarginsmob(){"block"!=$('.pe-form-group[data-tpl-field="margintop_res_480"]').css("display")?($('.pe-form-group[data-tpl-field="margintop_res_480"]').css("display","block"),$('.pe-form-group[data-tpl-field="marginbottom_res_480"]').css("display","block")):($('.pe-form-group[data-tpl-field="margintop_res_480"]').css("display","none"),$('.pe-form-group[data-tpl-field="marginbottom_res_480"]').css("display","none"))}function edrec__drawUI__split(field1,field2){var el1=$('.pe-form-group[data-tpl-field="'+field1+'"]'),el2=$('.pe-form-group[data-tpl-field="'+field2+'"]'),html1=el1.html(),html2=el2.html();el2.remove();var str="";str+='<div class="pe-form-group">',str+='<table class="pe-table">',str+="<tr>",str+='<td class="pe-table-col1" valign="bottom">',str+=html1,str+="</td>",str+='<td class="pe-table-col2" valign="bottom">',str+=html2,str+="</td>",str+="</tr>",str+="</div>",el1.html(str)}function edrec__drawUI__podcut(data,fields,wrapper){var field;for(var key in fields){if("buttoncolor"==(field=fields[key])){var arr=["buttonshadowsize","buttonshadowopacity","buttonfontfamily","buttonfontweight","buttonuppercase","buttonbgcolorhover","buttoncolorhover","buttonbordercolorhover","buttonshadowsizehover","buttonshadowopacityhover","buttonspeedhover"],str="";str+='<div id="pe_showmorebtnsettings" style="display:none;">',str+='<div style="padding-top:10px;margin-top:-30px;margin-bottom:40px;"><a href="javascript:showbtnsetmore();" id="pe_btn_showmorebtnsettings_off" style="padding:10px 0px;">'+("RU"==lang?"Свернуть доп. настройки":"Minimize options")+"</a></div>",str+="";var additionalBtnSettings=[];for(var i in arr){var el;if((el=wrapper.find('.pe-form-group[data-tpl-field="'+arr[i]+'"]')).length>0){var h=el[0].outerHTML;additionalBtnSettings.push(arr[i]),el.remove(),str+=h}}str+="</div>",str+="</div>",str+="<script>",str+="function showbtnsetmore(){",str+='\t$("#pe_showmorebtnsettings").toggle();',str+='\t$("#pe_btn_showmorebtnsettings").toggle();',str+="}",str+="<\/script>",void 0===data.tpl.is_email&&0!==additionalBtnSettings.length&&(str+='<a href="javascript:showbtnsetmore();" id="pe_btn_showmorebtnsettings" style="display:block; padding:10px 0px; margin-top:-30px;margin-bottom:30px;">'+("RU"==lang?"Дополнительные настройки":"Show more settings")+"</a>"),wrapper.find('.pe-form-group[data-tpl-field="buttonradius"]').after(str),wrapper.find('input[name="buttonuppercase-cb"]').change((function(){var tempv=$(this).is(":checked");tempv=tempv?"on":"",wrapper.find('input[name="buttonuppercase"]').val(tempv)}))}if("bbuttoncolor"==field){var arr=["bbuttonshadowsize","bbuttonshadowopacity","bbuttonfontfamily","bbuttonfontweight","bbuttonuppercase","bbuttonbgcolorhover","bbuttoncolorhover","bbuttonbordercolorhover","bbuttonshadowsizehover","bbuttonshadowopacityhover","bbuttonspeedhover"],str="";for(var i in str+='<div id="pe_showmorebbtnsettings" style="display:none;">',str+='<div style="padding-top:10px;margin-top:-30px;margin-bottom:40px;"><a href="javascript:showbbtnsetmore();" id="pe_btn_showmorebbtnsettings_off" style="padding:10px 0px;">'+("RU"==lang?"Свернуть доп. настройки":"Minimize options")+"</a></div>",str+="",arr){var el;if((el=wrapper.find('.pe-form-group[data-tpl-field="'+arr[i]+'"]')).length>0){var h=el[0].outerHTML;el.remove(),str+=h}}str+="</div>",str+="</div>",str+="<script>",str+="function showbbtnsetmore(){",str+='\t$("#pe_showmorebbtnsettings").toggle();',str+='\t$("#pe_btn_showmorebbtnsettings").toggle();',str+="}",str+="<\/script>",void 0===data.tpl.is_email&&(str+='<a href="javascript:showbbtnsetmore();" id="pe_btn_showmorebbtnsettings" style="display:block; padding:10px 0px; margin-top:-30px;margin-bottom:30px;">'+("RU"==lang?"Дополнительные настройки":"Show more settings")+"</a>"),wrapper.find('.pe-form-group[data-tpl-field="bbuttonradius"]').after(str)}}}function edrec__replaces(replaces,wrapper){var r,el,label,hint,chb_title,inp_placeholder;for(var key in replaces){if(void 0!==(r=replaces[key]).field&&""!=r.field){var field=r.field;(label="RU"==lang&&void 0!==r.label_ru&&""!=r.label_ru?r.label_ru:void 0!==r.label&&""!=r.label?r.label:"").replace(/"/g,"&quot;"),(hint="RU"==lang&&void 0!==r.hint_ru&&""!=r.hint_ru?r.hint_ru:void 0!==r.hint&&""!=r.hint?r.hint:"").replace(/"/g,"&quot;"),(chb_title="RU"==lang&&void 0!==r.chb_title_ru&&""!=r.chb_title_ru?r.chb_title_ru:void 0!==r.chb_title&&""!=r.chb_title?r.chb_title:"").replace(/"/g,"&quot;"),(inp_placeholder=void 0!==r.inp_placeholder&&""!=r.inp_placeholder?r.inp_placeholder:"").replace(/"/g,"&quot;"),el=wrapper.find("[data-tpl-field="+field+"]"),""!==label&&el.find(".pe-label").html(label),""!==hint&&el.find(".pe-hint").html(hint),""!==chb_title&&el.find(".pe-checkbox-title").html(chb_title),""!==inp_placeholder&&el.find(".pe-input").attr("placeholder",inp_placeholder),void 0!==r.noredactor&&"yes"==r.noredactor&&($("[data-tpl-field="+field+"]").find("[name="+field+"]").attr("id","noredactor"),"q"!==window.ver_redactor?$("[data-tpl-field="+field+"]").find("[name="+field+"]").redactor("core.destroy"):($("[data-tpl-field="+field+"]").find("[name="+field+"]").css("display",""),$("[data-tpl-field="+field+"]").find("[quill-name="+field+"] .ql-editor").parent().parent().find(".ql-toolbar").remove(),$("[data-tpl-field="+field+"]").find("[quill-name="+field+"] .ql-editor").parent().remove()),$("[data-tpl-field="+field+"]").find("[name="+field+"]").closest(".pe-redactor").addClass("pe-noredactor")),void 0!==r.fieldheight&&""!=r.fieldheight&&$("[data-tpl-field="+field+"]").find("[name="+field+"]").css("height",r.fieldheight),void 0!==r.redactor_nohref&&"yes"===r.redactor_nohref&&($("[data-tpl-field="+field+"]").find(".re-link").css("display","none"),$("[data-tpl-field="+field+"]").find(".ql-link_custom").css("display","none")),void 0!==r.redactor_notoolbar&&"yes"===r.redactor_notoolbar&&$("[data-tpl-field="+field+"]").find(".ql-toolbar").remove(),void 0!==r.menuitems_nolinktarget&&"yes"==r.menuitems_nolinktarget&&$("[data-tpl-field="+field+"]").find(".pe-menuitems__linktarget").css("display","none")}else void 0!==r.group&&""!=r.group&&((label="RU"==lang&&void 0!==r.label_ru&&""!=r.label_ru?r.label_ru:void 0!==r.label&&""!=r.label?r.label:"").replace(/"/g,"&quot;"),wrapper.find("#grouptitle_"+r.group).find(".tsgrouptitle").html(label));void 0!==r.action&&"adddata"==r.action&&void 0!==r.selector&&""!=r.selector&&void 0!==r.key&&""!=r.key&&(r.key.replace(/"/g,"&quot;"),r.value.replace(/"/g,"&quot;"),wrapper.find(r.selector).attr("data-"+r.key,r.value))}}function edrec__content__init(wrapper){edrec__initRedactor(wrapper),setTimeout((function(){$(".editrecordcontent_container").find(".pe-hint").each((function(){""==$(this).html()&&$(this).css("padding","0px")}))}),50),setTimeout((function(){$('[data-need-check-link="yes"]').change((function(){var v=$(this).val();checkLinkCCtoWS(v)})),$(".pe-form-group",wrapper).each((function(){0==$(this).children().length&&$(this).remove()})),wrapper.find("input[type=text]").each((function(){var val=$(this).val();val&&val.length>0&&(val=val.replace(new RegExp("&amp;","g"),"&"),$(this).val(val))}));try{$(".pe-tooltip").each((function(){$(this).tooltipster({theme:"pe-tooltip__tooltipster-noir",contentAsHTML:!0,content:$(this).attr("data-tooltip"),interactive:!0,position:"top"})}))}catch(err){console.log("err")}}),500)}function edrec__copyproducts_to_catalog(pageid,recordid,projectid){showLoadIcon();var ts=Date.now();$.ajax({type:"POST",url:"/page/submit/",data:{comm:"copyproducts_to_catalog",pageid:pageid,recordid:recordid},dataType:"text",success:function(data){if(check_logout(data),""!=data&&"ok:"==data.substring(0,3)){k=data.substr(3);var str="RU"==lang?"Товары успешно скопированы. Добавлено продуктов: "+k+'. Перейдите в <a href="/identity/gostore/?projectid='+window.projectid+'" target="_blank" style="color:inherit;">каталог</a> и проверьте результат выполнения. Сами товары из этого блока вы можете удалить вручную.':"Adding was successful. Added products: "+k+'. Go to the <a href="/identity/gostore/?projectid='+window.projectid+'" target="_blank" style="color:inherit;">catalog</a> and check the result. You can delete products from this block manually.';str+="<br><br>&#9758; "+("RU"==lang?'Текст кнопки для товаров из каталога вы можете настроить во вкладке "Дополнительно"':'Go to "More" tab to define buttons for all products.'),$(".link_copyproductstocatalog_result").html('<br><span style="color:green;">'+str+"</span>"),$(".link_copyproductstocatalog").remove()}else alert(data)},error:function(xhr){var ts_delta=Date.now()-ts;0==xhr.status&&ts_delta<100?alert("Request error (export products to catalog). Please check internet connection..."):alert("Request timeout (export products to catalog)")},complete:function(xhr){hideLoadIcon()},timeout:6e4})}function edrec__addslashes(str){return"string"==typeof str&&""!=str&&str.length>0&&"undefined"==(str=str.replace(new RegExp('"',"g"),"&quot;"))&&(str=""),str}function edrec__collapsegroup(id){var el=$("#group_"+id);"none"==el.css("display")?(el.slideDown("slow"),el.parent().find("#grouptitle_"+id).find(".glyphicon").removeClass("glyphicon-circle-arrow-right").addClass("glyphicon-circle-arrow-down")):(el.slideUp("slow"),el.parent().find("#grouptitle_"+id).find(".glyphicon").removeClass("glyphicon-circle-arrow-down").addClass("glyphicon-circle-arrow-right"))}function edrec__opengroupitems($this,id,topCoord){var el=$("#group_"+id);if($(window).width()>640){if(0!=el.parents("#editforms").length){edrec__calculateGroupCoordAndHeight(el,topCoord),edrec__createCoordAndHeightObj(el);var elObj=window.group_height_coord[el.attr("id")],elTop=void 0!==elObj?elObj.top:0,elHeight=void 0!==elObj?elObj.height:0;edrec__openButtonExtendedSettings(),el.find(".minicolors").on("click",(function(){$(this).hasClass("minicolors-focus")&&edrec__scrollWithMinicolors($(this),elHeight)})),edrec__showSettingsGroup($this,el,id),$(".edrec__wrapper").on("click",(function(e){edrec__closeMinicolors(e,el,elTop,elHeight)}))}}else el.hasClass("pe-form-group-wrapper_open")?el.slideUp("slow",(function(){el.siblings("#grouptitle_"+id).removeClass("pe-form-group-title-wrapper_open"),el.removeClass("pe-form-group-wrapper_open"),el.parent().find("#grouptitle_"+id).find(".pe-form-group-arrow").removeClass("pe-form-group-arrow_open"),edrec__removeOpenGroup(el,id)})):(el.slideDown("slow"),el.siblings("#grouptitle_"+id).addClass("pe-form-group-title-wrapper_open"),el.addClass("pe-form-group-wrapper_open"),el.parent().find("#grouptitle_"+id).find(".pe-form-group-arrow").addClass("pe-form-group-arrow_open"))}function edrec__createCoordAndHeightObj(el){void 0===window.group_height_coord[el.attr("id")]&&(window.group_height_coord[el.attr("id")]={height:el.outerHeight(),top:parseInt(el.css("top"))}),void 0!==window.group_height_coord&&(window.group_height_coord[el.attr("id")].top=parseInt(el.css("top")))}function edrec__closeMinicolors(e,el,elTop,elHeight){var target=$(e.target),isNotMinicolors=!target.hasClass("minicolors-focus")&&!target.parents().hasClass("minicolors-focus"),isNotBtnSettings=!target.hasClass("pe-form-group-wrapper_showbtnsettings")&&!target.parents().hasClass("pe-form-group-wrapper_showbtnsettings"),isNotBtn="pe_btn_showmorebtnsettings"!=target.attr("id")&&"pe_btn_showmorebtnsettings_off"!=target.attr("id"),isNotBBtn="pe_btn_showmorebbtnsettings"!=target.attr("id")&&"pe_btn_showmorebbtnsettings_off"!=target.attr("id");isNotMinicolors&&isNotBtn&&isNotBBtn&&isNotBtnSettings&&(el.css("top",elTop),el.css("height",elHeight))}function edrec__scrollWithMinicolors($this,oldHeight){var el=$(".pe-form-group-wrapper_open"),windowHeight=$(window).height(),field=$this.parents(".pe-form-group[data-tpl-field]"),minicolorTopCoord,minicolorHeight,minicolorBottomCoord=field.position().top+field.outerHeight(!0)+$this.find(".minicolors-panel").height();minicolorBottomCoord>windowHeight&&el.scrollTop(el.scrollTop()+(minicolorBottomCoord-windowHeight)),minicolorBottomCoord>oldHeight&&minicolorBottomCoord<windowHeight&&!el.hasClass("pe-form-group-wrapper_showbtnsettings")&&(el.css("top",parseInt(el.css("top"))-(minicolorBottomCoord-el.outerHeight())),el.css("height",parseInt(el.css("height"))+(minicolorBottomCoord-el.outerHeight())))}function edrec__showSettingsGroup($this,el,id){el.hasClass("pe-form-group-wrapper_open")?edrec__closegroupitems():(edrec__closegroupitems(),$this.addClass("pe-form-group-title-wrapper_open"),el.addClass("pe-form-group-wrapper_open"),el.parent().find("#grouptitle_"+id).find(".pe-form-group-arrow").addClass("pe-form-group-arrow_open"))}function edrec__calculateGroupCoordAndHeight(el,topCoord){var defaultCoord=15,topPadding=20,windowHeight=$(window).height(),elBottomCoord=0,elObj=window.group_height_coord[el.attr("id")],newHeight=void 0!==elObj?elObj.newHeight:0,elHeight=el.outerHeight();if(void 0!==elObj&&void 0!==newHeight&&newHeight>0&&(elHeight=newHeight),el.outerHeight()>windowHeight-30)el.css({top:15,height:windowHeight-15});else if(el.css({top:topCoord-20,height:elHeight}),(elBottomCoord=parseInt(el.css("top"))+elHeight)>windowHeight){var diff=elBottomCoord-windowHeight;el.css("top",topCoord-20-diff-15)}}function edrec__openButtonExtendedSettings(){var defaultCoord=15;$("#pe_btn_showmorebtnsettings").on("click",(function(){edrec__onShowBtnSettings($(this),15)})),$("#pe_btn_showmorebbtnsettings").on("click",(function(){edrec__onShowBtnSettings($(this),15)})),$("#pe_btn_showmorebtnsettings_off").on("click",(function(){edrec__onHideBtnSettings($(this),15)})),$("#pe_btn_showmorebbtnsettings_off").on("click",(function(){edrec__onHideBtnSettings($(this),15)}))}function edrec__onShowBtnSettings($this,defaultCoord){var el=$this.parents(".pe-form-group-wrapper");el.css({top:defaultCoord,height:$(window).height()-defaultCoord}),el.addClass("pe-form-group-wrapper_showbtnsettings"),void 0!==window.group_height_coord[el.attr("id")]&&(window.group_height_coord[el.attr("id")].newTop=parseInt(el.css("top")),window.group_height_coord[el.attr("id")].newHeight=parseInt(el.css("height")))}function edrec__onHideBtnSettings($this,defaultCoord){var el=$this.parents(".pe-form-group-wrapper"),currentGroup=window.group_height_coord[el.attr("id")],groupTitle=el.attr("id").split("_")[1],titleWrapper=$('.pe-form-group-title-wrapper_open[data-tpl-group="'+groupTitle+'"]'),oldTop=titleWrapper.position().top+parseInt(titleWrapper.css("margin-top"))-20,oldHeight=void 0!==currentGroup?currentGroup.height:0,elBottomCoord=oldTop+oldHeight,diff;elBottomCoord>$(window).height()&&(oldTop=oldTop-20-(elBottomCoord-$(window).height())-defaultCoord);el.css({top:oldTop,height:oldHeight}),el.removeClass("pe-form-group-wrapper_showbtnsettings"),void 0!==window.group_height_coord[el.attr("id")]&&(window.group_height_coord[el.attr("id")].newTop=0,window.group_height_coord[el.attr("id")].newHeight=0)}function edrec__closegroupitems(){$(".pe-form-group-title-wrapper").removeClass("pe-form-group-title-wrapper_open"),$(".pe-form-group-wrapper").removeClass("pe-form-group-wrapper_open"),$(".pe-form-group-arrow").removeClass("pe-form-group-arrow_open")}function edrec__collapsecontentgroups(id){var el=$("#group_"+id);el.hasClass("pe-form-group-wrapper_open")?el.slideUp("slow",(function(){el.siblings("#grouptitle_"+id).removeClass("pe-form-group-title-wrapper_open"),el.removeClass("pe-form-group-wrapper_open"),el.parent().find("#grouptitle_"+id).find(".pe-form-group-arrow").removeClass("pe-form-group-arrow_open"),edrec__removeOpenGroup(el,id)})):(el.slideDown("slow"),el.siblings("#grouptitle_"+id).addClass("pe-form-group-title-wrapper_open"),el.addClass("pe-form-group-wrapper_open"),el.parent().find("#grouptitle_"+id).find(".pe-form-group-arrow").addClass("pe-form-group-arrow_open"),edrec__saveOpenGroup(el))}function edrec__removeOpenGroup(el,id){var recid=el.parents(".pe-content-form").attr("data-rec-id"),scrollOpenGroup=[];if(void 0!==window.contenttab_scroll_obj&&void 0!==window.contenttab_scroll_obj[recid]&&(scrollOpenGroup=window.contenttab_scroll_obj[recid].groupOpen),void 0!==scrollOpenGroup&&scrollOpenGroup.length>0){var index=scrollOpenGroup.indexOf(el.siblings("#grouptitle_"+id).attr("data-tpl-group"));scrollOpenGroup.splice(index,1)}}edrec__editRecordInit(),jQuery.loadScript=function(url,callback){jQuery.ajax({url:url,dataType:"script",success:callback,async:!0})},$.fn.scrollGuard=function(){return this.on("wheel",(function(e){var $this=$(this);return e.originalEvent.deltaY<0?$this.scrollTop()>0:$this.scrollTop()+$this.innerHeight()<$this[0].scrollHeight}))};